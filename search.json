[{"path":"http://steffilazerte.ca/bbsBayes/CODE_DESIGN.html","id":null,"dir":"","previous_headings":"","what":"Code Design","title":"Code Design","text":"file contains notes code design conventions aim making collaboration future modifications easier.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_DESIGN.html","id":"naming","dir":"","previous_headings":"","what":"Naming","title":"Code Design","text":"Snake case used wherever possible Functions generally named verb_noun() .e. run_model() prepare_data() R script files named foo-bar.R whereas main function file foo_bar.R","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_DESIGN.html","id":"documentation","dir":"","previous_headings":"","what":"Documentation","title":"Code Design","text":"Descriptions parameter arguments follow: @param arg_name Type. Description e.g., @param min_year Numeric. Minimum year plot e.g., @param add_map sf spatial object. Spatial data add map output e.g., @param quantiles Numeric vector. Quantiles sampled ... Document repetitive arguments (ones found one function) R/aa_common_docs.R file (named sort top folder), use @inheritParams common_docs function documentation. way duplicate documentation stays consistent. Use @noRd document internal functions (documentation developers isn’t compiled docs)","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_DESIGN.html","id":"checks","dir":"","previous_headings":"","what":"Checks","title":"Code Design","text":"Check functions named check_XXX() stored R/checks.R file really big (e.g., check_species() check_strata()), , used (e.g., check_sf(), check_logical()). ’s also justifiable create check functions ease reading code (e.g., list checks start run_model()). deparse(substitute(name)) way getting original argument name submitted function parent function. way check_XXX() functions can reference correct argument name error messages.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_DESIGN.html","id":"tidyeval-and-nse-non-standard-evaluation","dir":"","previous_headings":"","what":"Tidyeval and NSE (non-standard evaluation)","title":"Code Design","text":"general, see https://ggplot2.tidyverse.org/reference/tidyeval.html, https://ggplot2.tidyverse.org/reference/tidyeval.html avoid CRAN checks, use .data[[\"col_name\"]] .data$col_name reference column names right-hand side = inside tidyverse functions. Use `.env$varto reference environmental variables. e.g.,dplyr::mutate(mtcars, cyl = .datahp * .dataam)ordplyr::mutate(mtcars, mpg = .datampg/.envratio)` dplyr::group_by(.data[[rr]]) (note lack quotes, ’re calling value rr) dplyr::mutate(\"{rr}\" := .character(.data[[rr]]) (complex see references)","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_DESIGN.html","id":"sf-related","dir":"","previous_headings":"","what":"sf related","title":"Code Design","text":"Use sf::st_agr(sf) <- \"constant\" tell sf variables spatially constant (prevents warning “attribute variables assumed spatially constant throughout geometries”).","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_DESIGN.html","id":"testing-and-examples","dir":"","previous_headings":"","what":"Testing and examples","title":"Code Design","text":"doubt skip_on_cran() tests (never run fragile tests might fail) Use @examplesIf interactive() skip examples can run shouldn’t tested (e.g., fetch_bbs_data()) use \\dontest examples never run (try many) use \\dontrun examples won’t fail, take run.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_DESIGN.html","id":"random-notes","dir":"","previous_headings":"","what":"Random Notes","title":"Code Design","text":"Use “grey60” rather grDevices::grey(0.6) avoid another dependency species_forms exported data frame, means (stupid) reasons, bbsBayes functions (like fetch_bbs_data()) need reference via bbsBayes::species_forms (See details/options: https://coolbutuseless.github.io/2018/12/10/r-packages-internal--external-data/)","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_DESIGN.html","id":"deprecating-defunct-ing-and-other-big-changes","dir":"","previous_headings":"","what":"Deprecating, Defunct-ing, and other big changes","title":"Code Design","text":"See R/bbsBayes-defunct.R listing defunct packages document page See R/bbsBayes-deprectated.R listing deprecated packages document page dep_stop() dep_warn() created bbsBayes-defunct.R can used stop warn use functions arguments, depending. See ?plot_map vs ?generate_map v3.0.0 package entails massive overhaul, suggest using start message (R/bbsBayes-package.R) share users Add dep_warn() start function call either continue, switch new function (e.g., R/bbsBayes-deprectated.R) Add documentation bbsBayes-deprecated Add dep_stop() start function call remove rest code (clarity) (e.g., R/bbsBayes-defunct.R) Add documentation bbsBayes-defunct Move argument function() call end list, without default Move documentation argument end list mark “Deprecated. Use X instead”, just “Deprecated.” (Defunct) deprecated replacement, add (!missing(arg)) {dep_warn(...)} start function use arg_new <- arg_old inside condition (e.g., plot_indices()) defunct without replacement, add (!missing(arg)) dep_warn(...) (!missing(arg)) dep_stop(...)","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_DESIGN.html","id":"useful-tips","dir":"","previous_headings":"","what":"Useful tips","title":"Code Design","text":"Use Ctrl-Shift-L load package functions via devtools::load_all() see https://r-pkgs.org/workflow101.html#sec-load-Use Ctrl-Shift / automatically text-wrap Use Ctrl Click function jump function’s definition","code":""},{"path":[]},{"path":"http://steffilazerte.ca/bbsBayes/CODE_OF_CONDUCT.html","id":"our-pledge","dir":"","previous_headings":"","what":"Our Pledge","title":"Contributor Covenant Code of Conduct","text":"interest fostering open welcoming environment, contributors maintainers pledge making participation project community harassment-free experience everyone, regardless age, body size, disability, ethnicity, sex characteristics, gender identity expression, level experience, education, socio-economic status, nationality, personal appearance, race, religion, sexual identity orientation.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_OF_CONDUCT.html","id":"our-standards","dir":"","previous_headings":"","what":"Our Standards","title":"Contributor Covenant Code of Conduct","text":"Examples behavior contributes creating positive environment include: Using welcoming inclusive language respectful differing viewpoints experiences Gracefully accepting constructive criticism Focusing best community Showing empathy towards community members Examples unacceptable behavior participants include: use sexualized language imagery unwelcome sexual attention advances Trolling, insulting/derogatory comments, personal political attacks Public private harassment Publishing others’ private information, physical electronic address, without explicit permission conduct reasonably considered inappropriate professional setting","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_OF_CONDUCT.html","id":"our-responsibilities","dir":"","previous_headings":"","what":"Our Responsibilities","title":"Contributor Covenant Code of Conduct","text":"Project maintainers responsible clarifying standards acceptable behavior expected take appropriate fair corrective action response instances unacceptable behavior. Project maintainers right responsibility remove, edit, reject comments, commits, code, wiki edits, issues, contributions aligned Code Conduct, ban temporarily permanently contributor behaviors deem inappropriate, threatening, offensive, harmful.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_OF_CONDUCT.html","id":"scope","dir":"","previous_headings":"","what":"Scope","title":"Contributor Covenant Code of Conduct","text":"Code Conduct applies within project spaces public spaces individual representing project community. Examples representing project community include using official project e-mail address, posting via official social media account, acting appointed representative online offline event. Representation project may defined clarified project maintainers.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_OF_CONDUCT.html","id":"enforcement","dir":"","previous_headings":"","what":"Enforcement","title":"Contributor Covenant Code of Conduct","text":"Instances abusive, harassing, otherwise unacceptable behavior may reported contacting project team edwardsb@uoguelph.ca. complaints reviewed investigated result response deemed necessary appropriate circumstances. project team obligated maintain confidentiality regard reporter incident. details specific enforcement policies may posted separately. Project maintainers follow enforce Code Conduct good faith may face temporary permanent repercussions determined members project’s leadership.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CODE_OF_CONDUCT.html","id":"attribution","dir":"","previous_headings":"","what":"Attribution","title":"Contributor Covenant Code of Conduct","text":"Code Conduct adapted Contributor Covenant, version 1.4, available https://www.contributor-covenant.org/version/1/4/code--conduct.html answers common questions code conduct, see https://www.contributor-covenant.org/faq","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CONTRIBUTING.html","id":null,"dir":"","previous_headings":"","what":"Contributing to bbsBayes","title":"Contributing to bbsBayes","text":"Thank contributions! Following guidelines help streamline process contributing make sure ’re page. ask read guide follow best abilities, welcome contributions , regardless level experience. participating project, agree abide code conduct.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CONTRIBUTING.html","id":"types-of-contributions","dir":"","previous_headings":"","what":"Types of contributions","title":"Contributing to bbsBayes","text":"Don’t feel must computer whiz make meaningful contributions. Feel free : Identify areas future development ([open Issue]https://github.com/BrandonEdwards/bbsBayes/issues)) Identify issues/bugs (open Issue) Write tutorials/vignettes (open Pull Request contribute ones , make elsewhere send us link) Add functionality (open Pull Request) Fix bugs (open Pull Request)","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CONTRIBUTING.html","id":"new-to-github","dir":"","previous_headings":"","what":"New to GitHub?","title":"Contributing to bbsBayes","text":"Getting ready make first contribution? couple tutorials may wish check : Tutorial first-timers contribute (-depth lessons) GitHub setup GitHub pull requests.)","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CONTRIBUTING.html","id":"how-to-contribute-code","dir":"","previous_headings":"","what":"How to contribute code","title":"Contributing to bbsBayes","text":"Fork repository Clone repository GitHub computer e.g,. git clone https://github.com/BrandonEdwards/bbsBayes.git git remote add upstream https://github.com/BrandonEdwards/bbsBayes.git making changes make sure pull changes upstream git pull upstream changes beyond minor typos, add item NEWS.md describing changes add DESCRIPTION file contributor Push GitHub account Submit pull request home base (likely master branch, check make sure) BrandonEdwards/bbsBayes","code":""},{"path":"http://steffilazerte.ca/bbsBayes/CONTRIBUTING.html","id":"code-formatting","dir":"","previous_headings":"","what":"Code formatting","title":"Contributing to bbsBayes","text":"general follow convention http://r-pkgs..co.nz/r.html#style (snake_case functions argument names, etc.) conflict, default style bbsBayes Use explicit package imports (.e. package_name::package_function) avoid @import possible","code":""},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":[]},{"path":"http://steffilazerte.ca/bbsBayes/PULL_REQUEST_TEMPLATE.html","id":"best-practices","dir":"","previous_headings":"","what":"Best Practices","title":"NA","text":"following updated added needed: [ ] Documentation [ ] Examples documentation","code":""},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"basic-status-and-trend-analyses","dir":"Articles","previous_headings":"","what":"Basic Status and Trend Analyses","title":"Advanced Example","text":"bbsBayes provides functions every stage Breeding Bird Survey data analysis.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"data-retrieval","dir":"Articles","previous_headings":"Basic Status and Trend Analyses","what":"Data Retrieval","title":"Advanced Example","text":"can download BBS data running fetch_bbs_data. save package-specific directory computer. must agree terms conditions data usage downloading. need run function annual update BBS database.","code":"fetch_bbs_data()"},{"path":[]},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"stratification","dir":"Articles","previous_headings":"Basic Status and Trend Analyses > Data Preparation","what":"Stratification","title":"Advanced Example","text":"Stratification plays important role trend analysis. Use stratify() function job. Set argument stratify following options: bbs_cws – Political region X Bird Conservation region intersection (Canadian Wildlife Service [CWS] method) bbs_usgs – Political region X Bird Conservation region intersection (United Status Geological Survey [USGS] method) bcr – Bird Conservation Region state – Political Region latlong – Degree blocks (1 degree latitude X 1 degree longitude)","code":"s <- stratify(by = \"bbs_cws\", species = \"Barn Swallow\",)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"stan-data","dir":"Articles","previous_headings":"Basic Status and Trend Analyses > Data Preparation","what":"Stan Data","title":"Advanced Example","text":"Stan models require data sent list depending model set . prepare_data() subsets stratified data based species wrangles relevant data use Stan models.","code":"prepped_data <- prepare_data(s, min_max_route_years = 5)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"mcmc","dir":"Articles","previous_headings":"Basic Status and Trend Analyses","what":"MCMC","title":"Advanced Example","text":"data prepared Stan, model can run. following run MCMC default number iterations. Note step usually takes long time (e.g., 6-12 hours, even days depending species, model). Alternatively, can set many iterations sampling warmup steps, many chains, many run parallel. run_model() function generates large object includes posterior draws, convergence information, data, etc.","code":"mod <- run_model(prepped_data,                   model = \"gamye\",                  heavy_tailed = TRUE,                   iter_sampling = 10, iter_warmup = 10, chains = 2) readr::write_rds(mod, \"cws_bars_gamye.rds\") mod <- run_model(prepped_data,                  iter_sampling = 2000, iter_warmup = 500,                   chains = 4, parallel_chains = 2)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"convergence","dir":"Articles","previous_headings":"Basic Status and Trend Analyses","what":"Convergence","title":"Advanced Example","text":"run_model() function send warning Gelman-Rubin Rhat cross-chain convergence criterion > 1.1 monitored parameters. Re-running model longer burn-/posterior iterations greater thinning rates may improve convergence. seriousness convergence failures something user must interpret . cases parameters model may separately estimable, direct inference drawn separate parameters, convergence may necessary. vast majority n parameters converged (e.g., ’re receiving warning message monitored parameters), inference population trajectories trends model reliable. important monitored parameters converged, recommend inspecting model diagnostics package ggmcmc. bbsBayes also includes function help re-start MCMC chain, avoid wait additional burn-period.","code":"jags_mod$n.eff #shows the effective sample size for each monitored parameter jags_mod$Rhat # shows the Rhat values for each monitored parameter install.packages(\"ggmcmc\") S <- ggmcmc::ggs(jags_mod$samples,family = \"B.X\") #samples object is an mcmc.list object ggmcmc::ggmcmc(S,family = \"B.X\") ## this will output a pdf with a series of plots useful for assessing convergence. Be warned this function will be overwhelmed if trying to handle all of the n values from a BBS analysis of a broad-ranged species ### if jags_mod has failed to converge... new_initials <- get_final_values(jags_mod)  jags_mod2 <- run_model(jags_data = jags_data,                                n_saved_steps = 1000,                                n_burnin = 0,                                n_chains = 3,                                n_thin = 10,                                parallel = FALSE,                                inits = new_initials,                           parameters_to_save = c(\"n\", \"n3\", \"nu\", \"B.X\", \"beta.X\", \"strata\", \"sdbeta\", \"sdX\"),                           modules = NULL)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"model-predictions","dir":"Articles","previous_headings":"","what":"Model Predictions","title":"Advanced Example","text":"number tools available summarize visualize posterior predictions model.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"annual-indices-of-abundance-and-population-trajectories","dir":"Articles","previous_headings":"Model Predictions","what":"Annual Indices of Abundance and Population Trajectories","title":"Advanced Example","text":"main monitored parameters annual indices relative abundance within stratum (.e., parameters n[strata,year]). time-series annual indices form estimated population trajectories. default, function generates estimates continent (.e., survey-wide) individual strata. However, user can also select summaries composite regions (regions made collections strata), countries, provinces/states, Bird Conservation Regions, etc. display, posterior medians used annual indices (instead posterior means) due asymetrical distributions caused log-linear retransformation.","code":"indices <- generate_indices(mod) indices <- generate_indices(mod,                             regions = c(\"continental\",                                         \"national\",                                         \"prov_state\",                                         \"stratum\"))                            # also \"bcr\", \"bcr_by_country\""},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"population-trends","dir":"Articles","previous_headings":"Model Predictions","what":"Population Trends","title":"Advanced Example","text":"Population trends can calculated series annual indices abundance. trends expressed geometric mean rates change (%/year) two points time. \\(Trend = (\\frac {n[minyear]}{n[maxyear]})^{(1/(maxyear-minyear))}\\) generate_trends() function returns dataframe 1 row unit region-types requested generate_indices() function (.e., 1 stratum, 1 continental, etc.). dataframe least 27 columns report useful information related trend, including start end year trend, lists included strata, total number routes, number strata, mean observed counts, estimates % change population start end years. generate_trends() function includes arguments allow user adjust quantiles used summarize uncertainty (e.g., interquartile range trend estiamtes, 67% CIs), well include additional calculations, probability population declined (increased) > X%.","code":"trends <- generate_trends(indices = indices,                             min_year = 1970,                           max_year = 2018) trends <- generate_trends(indices = indices,                           min_year = 1970,                           max_year = 2018,                           prob_decrease = c(0, 25, 30, 50),                           prob_increase = c(0, 33, 100))"},{"path":[]},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"population-trajectories","dir":"Articles","previous_headings":"Visualizing Predictions","what":"Population Trajectories","title":"Advanced Example","text":"Generate plots population trajectories time. plot_indices() function produces list ggplot figures can combined single pdf file, printed individual devices.  etc.","code":"tp <- plot_indices(indices = indices,                    add_observed_means = TRUE) # pdf(file = \"Barn Swallow Trajectories.pdf\") # print(tp) # dev.off() tp[[1]] tp[[2]]"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"trend-maps","dir":"Articles","previous_headings":"Visualizing Predictions","what":"Trend Maps","title":"Advanced Example","text":"trends can mapped produce strata maps coloured species population trends.","code":"mp <- plot_map(trends, col_viridis = FALSE) mp"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"geofacet-trajectories","dir":"Articles","previous_headings":"Visualizing Predictions","what":"Geofacet Trajectories","title":"Advanced Example","text":"","code":"gf <- plot_geofacet(indices_list = indices,                     trends = trends,                     multiple = TRUE,                     slope = FALSE)  #png(\"BARS_geofacet.png\",width = 1500, height = 750,res = 150) print(gf) #dev.off()"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"example---replicating-the-cws-status-and-trend-estimates-2018-version-onwards","dir":"Articles","previous_headings":"","what":"EXAMPLE - Replicating the CWS status and trend estimates (2018 version onwards)","title":"Advanced Example","text":"CWS analysis, 2018 BBS data-version, uses GAMYE model. also monitors two estimates population trajectory: * one visualizing trajectory includes annual fluctuations estimated year-effects “n” * another calculation trends using trajectory removes annual fluctuations around smooth “n3”. full script run CWS analysis 2018 BBS data version accessible : https://github.com/AdamCSmithCWS/BBS_Summaries","code":"species.eng = \"Pacific Wren\"  stratified_data <- stratify(by = \"bbs_cws\") #same as USGS but with BCR7 as one stratum and PEI and Nova Scotia combined into one stratum  jags_data <- prepare_jags_data(strat_data = stratified_data,                                  species_to_run = species.eng,                                  min_max_route_years = 5,                                  model = \"gamye\",                                   heavy_tailed = T) #heavy-tailed version of gamye model                                                                     jags_mod <- run_model(jags_data = jags_data,                                n_saved_steps = 2000,                                n_burnin = 10000,                                n_chains = 3,                                n_thin = 20,                                parallel = F,                            parameters_to_save = c(\"n\",\"n3\",\"nu\",\"B.X\",\"beta.X\",\"strata\",\"sdbeta\",\"sdX\"),                           modules = NULL)   # n and n3 allow for index and trend calculations, other parameters monitored to help assess convergence and for model testing"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"example---replicating-approximately-the-earlier-usgs-status-and-trend-estimates-2011---2017-data-versions","dir":"Articles","previous_headings":"","what":"EXAMPLE - Replicating (approximately) the earlier USGS status and trend estimates (2011 - 2017 data versions)","title":"Advanced Example","text":"USGS analysis, 2011 2017, uses SLOPE model. Future analyses USGS likely use first difference model (see, Link et al. 2017 https://doi.org/10.1650/CONDOR-17-1.1) NOTE: USGS analysis run using bbsBayes package, analysis may exactly replicate published version. However, variations minor.","code":"species.eng = \"Pacific Wren\"  stratified_data <- stratify(by = \"bbs_usgs\") #BCR by province/state/territory intersections  jags_data <- prepare_jags_data(strat_data = stratified_data,                                  species_to_run = species.eng,                                  min_max_route_years = 1,                                  model = \"slope\",                                   heavy_tailed = FALSE) #normal-tailed version of slope model                                                                     jags_mod <- run_model(jags_data = jags_data,                                n_saved_steps = 2000,                                n_burnin = 10000,                                n_chains = 3,                                n_thin = 20,                                parallel = FALSE,                                track_n = FALSE,                                parameters_to_save = c(\"n2\"), #more on this alternative annual index below                           modules = NULL)"},{"path":[]},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"alternative-models","dir":"Articles","previous_headings":"","what":"Alternative Models","title":"Advanced Example","text":"package (currently) four status trend models differ somewhat way model time-series observations. four model options slope, gam, gamye, firstdiff.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"slope","dir":"Articles","previous_headings":"Alternative Models","what":"slope","title":"Advanced Example","text":"slope option estimates time series log-linear regression random year-effect terms allow trajectory depart smooth regression line. model used USGS CWS estimate bbs trends since 2011. basic model first described 2002 (Link Sauer 2002; https://doi.org/10.1890/0012-9658(2002)083[2832:AHAOPC]2.0.CO;2) application annual status trend estimates documented Sauer Link (2011; https://doi.org/10.1525/auk.2010.09220) Smith et al. (2014; https://doi.org/10.22621/cfn.v128i2.1565).","code":"#stratified_data <- stratify(by = \"bbs_usgs\")          #jags_data_slope <- prepare_jags_data(stratified_data,      #                           species_to_run = \"American Kestrel\",     #                           min_max_route_years = 3,     #                           model = \"slope\")      #jags_mod_full_slope <- run_model(jags_data = jags_data)                                     slope_ind <- generate_indices(jags_mod = jags_mod_full_slope,                                   jags_data = jags_data_slope,                                   regions = c(\"continental\"))     slope_plot = plot_indices(indices = slope_ind,                          species = \"American Kestrel SLOPE\",                          add_observed_means = TRUE)     #png(\"AMKE_Slope.png\", width = 1500,height = 900,res = 150)     print(slope_plot)     #dev.off()"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"gam","dir":"Articles","previous_headings":"Alternative Models","what":"gam","title":"Advanced Example","text":"gam option models time series semiparametric smooth using Generalized Additive Model (GAM) structure. See https://github.com/AdamCSmithCWS/Smith_Edwards_GAM_BBS information (full publication coming soon)","code":"#stratified_data <- stratify(by = \"bbs_usgs\")          #jags_data_gam <- prepare_jags_data(stratified_data,      #                           species_to_run = \"American Kestrel\",     #                           min_max_route_years = 3,     #                           model = \"gam\")      #jags_mod_full_gam <- run_model(jags_data = jags_data)                                     gam_ind <- generate_indices(jags_mod = jags_mod_full_gam,                                 jags_data = jags_data_gam,                                 regions = c(\"continental\"))     gam_plot = plot_indices(indices = gam_ind,                          species = \"American Kestrel GAM\",                          add_observed_means = TRUE)     #png(\"AMKE_gam.png\", width = 1500,height = 900,res = 150)     print(gam_plot)     #dev.off()"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"gamye","dir":"Articles","previous_headings":"Alternative Models","what":"gamye","title":"Advanced Example","text":"gamye option includes semiparametric smooth used gam option, also includes random year-effect terms track annual fluctuations around smooth. model Canadian Wildlife Service now using annual status trend estimates.","code":"#stratified_data <- stratify(by = \"bbs_usgs\")          #jags_data_gamye <- prepare_jags_data(stratified_data,      #                           species_to_run = \"American Kestrel\",     #                           min_max_route_years = 3,     #                           model = \"gamye\")      #jags_mod_full_gamye <- run_model(jags_data = jags_data)                                     gamye_ind <- generate_indices(jags_mod = jags_mod_full_gamye,                                   jags_data = jags_data_gamye,                                   regions = c(\"continental\"))     gamye_plot = plot_indices(indices = gamye_ind,                          species = \"American Kestrel GAMYE\",                          add_observed_means = TRUE)     #png(\"AMKE_gamye.png\", width = 1500,height = 900,res = 150)     print(gamye_plot)     #dev.off()"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"firstdiff","dir":"Articles","previous_headings":"Alternative Models","what":"firstdiff","title":"Advanced Example","text":"firstdiff option models time-series random-walk first year, first-differences sequence year-effects random effects mean = 0 estimated variance. model described Link et al. 2017 https://doi.org/10.1650/CONDOR-17-1.1","code":"#stratified_data <- stratify(by = \"bbs_usgs\")          #jags_data_firstdiff <- prepare_jags_data(stratified_data,      #                           species_to_run = \"American Kestrel\",     #                           min_max_route_years = 3,     #                           model = \"firstdiff\")      #jags_mod_full_firstdiff <- run_model(jags_data = jags_data)                                     firstdiff_ind <- generate_indices(jags_mod = jags_mod_full_firstdiff,                                       jags_data = jags_data_firstdiff,                                       regions = c(\"continental\"))     firstdiff_plot = plot_indices(indices = firstdiff_ind,                          species = \"American Kestrel FIRSTDIFF\",                          add_observed_means = TRUE)     #png(\"AMKE_firstdiff.png\", width = 1500,height = 900,res = 150)     print(firstdiff_plot)     #dev.off()"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"alternate-extra-poisson-error-distributions","dir":"Articles","previous_headings":"","what":"Alternate extra-Poisson error distributions","title":"Advanced Example","text":"models, BBS counts given route year modeled Poisson variables -dispersion. -dispersion approach used add count-level random effect adds extra variance unit variance:mean ratio Poisson. prepare_jags_data function, user can choose two distributions model extra-Poisson variance: default normal distribution (heavy_tailed = FALSE) alternative heavy-tailed t-distribution. (heavy_tailed = TRUE) heavy-tailed version well supported many species, particularly species sometimes observed large groups. Note: heavy-tailed version can require significantly time converge (~2-5 fold increase processing time).","code":"#stratified_data <- stratify(by = \"bbs_usgs\")          #jags_data_firstdiff <- prepare_jags_data(stratified_data,      #                           species_to_run = \"American Kestrel\",     #                           min_max_route_years = 3,     #                           model = \"firstdiff\",     #                           heavy_tailed = TRUE)       #jags_mod_full_firstdiff <- run_model(jags_data = jags_data)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"alternate-annual-indices-and-resulting-trends","dir":"Articles","previous_headings":"","what":"Alternate Annual Indices and Resulting Trends","title":"Advanced Example","text":"models, default measure annual index abundance (yearly component population trajectory) derived parameter “n”. run_model function monitors n default, parameters form basis estimated population trajectories trends.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"alternate-retransformations","dir":"Articles","previous_headings":"Alternate Annual Indices and Resulting Trends","what":"Alternate retransformations","title":"Advanced Example","text":"two ways calculating annual indices model. two approaches differ way calculate retransformation log-scale model parameters count-scale predictions. user can choose using following arguments run_model() generate_indices(). default, estimates mean expected counts existing combinations observers routes given stratum year. approach retransforms annual prediction every observer-route combination stratum averages across predictions. alternative, parameters_to_save = c(\"n2\"), track_n = FALSE actually standard approach used USGS status trend estimates. estimates expected count new observer-route combination, assuming distribution observer-route effects approximately normal. approach uses log-normal retransformation factor adds half estimated variance observer-route effects log-scale prediction year stratum, retransforms log-scale prediction count-scale. approach described Sauer Link (2011; https://doi.org/10.1525/auk.2010.09220). default approach parameters_to_save = c(\"n\") slightly underestimates uncertainty annual indices (slightly narrower CI width). However, chosen approach default : much accurately represents observed mean counts, allows intuitive interpretation annual indices; accurately represents relative contribution stratum combined (e.g., continental national) population trajectory trends. alternative n2 approach tends overestimate observed mean counts, bias varies among strata, affects strata’s contribution combined regional estimates. small underestimate uncertainty annual indices, affect uncertainty trend estimates.","code":"mod <- run_model(... ,                  parameters_to_save = \"n\",                  ... ) indices <- generate_indices(... ,                             alternate_n = \"n\",                             ... ) mod <- run_model(... ,                  parameters_to_save = \"n2\",                  ... ) indices <- generate_indices(... ,                             alternate_n = \"n2\",                             ... )"},{"path":[]},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"decomposing-the-population-trajectories-for-two-of-the-models","dir":"Articles","previous_headings":"Alternate Annual Indices and Resulting Trends","what":"Decomposing the population trajectories for two of the models","title":"Advanced Example","text":"two main model types \"slope\" \"gamye\", users can choose two different ways calculate trajectories population trends. two model types, population trajectories composed two largely independent components, long-term smooth random annual fluctuations around smooth. two components largely independent, population trajectory can decomposed. default approach include annual fluctuations around linear (slope) GAM-smooth (gamye) components trajectories. trend estimates comprehensive include full estimated trajectory, vary subsequent years (e.g., variability 1970-2017 trend 1970-2018 trend), include effects annual fluctuations. alternative approach decompose full trajectory exclude annual fluctuations around linear (slope) smooth (gamye) components. case, predicted trends much stable subsequent years. CWS status trend analyses, visualized population trajectories calculated using full trajectory, trend estimates derived decomposed trajectory using smooth component. example, figure (produced using modified version standard plotting functions), shows two kinds trajectories Pacific Wren 2018 CWS analysis. light-blue trajectory visualized trajectory, including yearly fluctuations. orange trajectory one used trend calculations, includes GAM-smooth component. kinds broad-scale status assessments form primary use published estimates trends, decomposition particularly useful feature two models.","code":"mod <- run_model(... ,                  parameters_to_save = \"n\",                  ... ) indices <- generate_indices(... ,                             alternate_n = \"n\",                             ... ) mod <- run_model(... ,                  parameters_to_save = c(\"n\",\"n3\"),                  ... ) indices_visualize <- generate_indices(... ,                                       alternate_n = \"n\",                                       ... ) indices_trend_calculation <- generate_indices(... ,                                               alternate_n = \"n3\",                                               ... )"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"the-figure-below-provides-another-example-of-the-benefits-of-removing-the-year-effect-annual-fluctuations-when-calculating-trends-","dir":"Articles","previous_headings":"Alternate Annual Indices and Resulting Trends > Decomposing the population trajectories for two of the models","what":"The figure below provides another example of the benefits of removing the year-effect annual fluctuations when calculating trends.","title":"Advanced Example","text":"point graph represents 10-year trend estimate Wood Thrush Canada, ending given year (e.g., points 2015 represent species national population trend 2005-2015). red green points trend estimates default trend estimates derived full population trajectories gamye slope models. Blue points represent trends calculated using decomposed trajectory gamye model, including smooth component. annual fluctuations included (SLOPE GAMYE including Year Effects), population trends surpass IUCN trend-criterion, years (e.g., 2011) suggesting assessed years species listed Threatened (trend orange region). However, stable trend estimate decomposed trajectory (GAMYE - Smooth Blue) shows species probably best thought decline, surpassing Threatened criterion.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"alternate-measures-of-trend-and-population-change","dir":"Articles","previous_headings":"","what":"Alternate Measures of Trend and Population Change","title":"Advanced Example","text":"generate_trends() function produces much just trend estimates.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"slope-trends","dir":"Articles","previous_headings":"Alternate Measures of Trend and Population Change","what":"Slope Trends","title":"Advanced Example","text":"default trend calculation interval-specific estimate geometric mean annual change population. \\(Trend = (\\frac {n[Minyear]}{n[Maxyear]})^{(1/(Maxyear-Minyear))}\\) relies comparison annual indices first last years trend period quantify mean rate population change. However, ignores pattern change two end-points. user can choose alternative estimate change calculated fitting log-linear slope series annual indices two end-points (e.g., 11 years 10-year trend 2008-2018). slope line expressed average annual percent change across time-period interest. working estimates derived model strong annual fluctuations decomposition possible (e.g., “firstdiff” model), slope-based trend may comprehensive measure average population change, less dependent particular end-point years. slope trends can added trend output table setting slope = TRUE argument generate_trends(). standard trends still calculated, additional columns added include alternate estimates. NOTE: plot_map() function can map slope trends well slope = TRUE argument.","code":"#jags_data_firstdiff <- prepare_jags_data(stratified_data,      #                           species_to_run = \"American Kestrel\",     #                           model = \"firstdiff\")      #jags_mod_full_firstdiff <- run_model(jags_data = jags_data)                                     #firstdiff_ind <- generate_indices(jags_mod = jags_mod_full_firstdiff,     #                                  jags_data = jags_data_firstdiff,     #                                  regions = c(\"continental\",\"stratum\"))     fd_slope_trends_08_18 <- generate_trends(indices = firstdiff_ind,                                              Min_year = 2008,                                              Max_year = 2018,                                              slope = TRUE)     plot_map(fd_slope_trends_0.8_18,                  slope = TRUE,                  stratify_by = \"bbs_usgs\")     )"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"percent-change-and-probability-of-change","dir":"Articles","previous_headings":"Alternate Measures of Trend and Population Change","what":"Percent Change and probability of change","title":"Advanced Example","text":"generate_trends() function also produces estimates overall percent-change population first last years trend-period. calculation often easier interpret average annual rate change. percent change estimates associated uncertainty bounds, can helpful deriving statements “2008 2018, population declined 20 percent, estimate relatively uncertain true decline may little 2 percent much 50 percent” addition, function can optionally calculate posterior conditional probability population changed least certain amount, using prob_decrease prob_increase arguments. values can useful deriving statements “model suggests 95% probability species increased (.e., > 0% increase) 45 percent probability species increased 2-fold (.e., > 100% increase)”","code":"fd_slope_trends_08_18 <- generate_trends(indices = firstdiff_ind,                                              Min_year = 2008,                                              Max_year = 2018,                                              slope = TRUE,                                              prob_increase = c(0,100))"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"custom-regional-summaries","dir":"Articles","previous_headings":"","what":"Custom regional summaries","title":"Advanced Example","text":"Yes, can calculate trend trajectories custom combinations strata, trends Eastern Western populations Lincoln’s Sparrow. Assuming setup run. user generate population trajectories using customized grouping original strata. First extract dataframe defines original strata used analysis. add column dataframe groups original strata desired custom regions. st_comp_regions can now used dataframe input argument alt_region_names generate_indices(), “East_West” value argument regions. relevant trends can calculated using just generate_trends() function.","code":"#stratification <- \"bbs_cws\"     #strat_data <- stratify(by = stratification, sample_data = TRUE)     #jags_data <- prepare_jags_data(strat_data,      #                           species_to_run = \"Lincoln's Sparrow\",     #                           model = \"gamye\")      #jags_mod <- run_model(jags_data = jags_data) st_comp_regions <- get_composite_regions(strata_type = stratification) st_comp_regions$East_West <- ifelse(st_comp_regions$bcr %in% c(7,8,12:14,22:31),\"East\",\"West\") east_west_indices <- generate_indices(jags_mod = jags_mod,                                       jags_data = jags_data,                                       alt_region_names = st_comp_regions,                                       regions = \"East_West\") east_west_trends <- generate_trends(indices = east_west_indices)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"exporting-the-jags-model","dir":"Articles","previous_headings":"","what":"Exporting the JAGS model","title":"Advanced Example","text":"can easily export bbsBayes models text file. , can modify model text (e.g., try different prior) run modified model Details coming soon…","code":"model_to_file(model = \"slope\",               filename = \"my_slope_model.txt\") run_model <- function(... ,                       model_file_path = \"my_modified_slope_model.txt\",                       ... )"},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"modifying-the-jags-model-and-data","dir":"Articles","previous_headings":"","what":"Modifying the JAGS model and data","title":"Advanced Example","text":"can even export bbsBayes model text, modify add covariates. example GAM smooth estimate effect day year observations, annual weather covariate, … add relevant covariate data jags_data object, ’re ! ’ll add details examples soon.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/articles/advanced.html","id":"comparing-models","dir":"Articles","previous_headings":"","what":"Comparing Models","title":"Advanced Example","text":"Finally, bbsBayes can used run Bayesian cross-validations. example, get_final_values() function useful provide efficient starting point cross-validation runs, without wait another full burn-period. Paper includes example implement cross-validation using bbsBayes. Pre-print: https://doi.org/10.1101/2020.03.26.010215 Supplement: NOTE: although bbsBayes includes functions calculate WAIC, recent work shown WAIC performs poorly BBS data (https://doi.org/10.1650/CONDOR-17-1.1). recommend k-fold cross-validation approach, zenodo archive.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/articles/bbsBayes.html","id":"install-cmdstanr","dir":"Articles","previous_headings":"","what":"Install cmdstanr","title":"Get Started","text":"","code":"# we recommend running this is a fresh R session or restarting your current session install.packages(\"cmdstanr\", repos = c(\"https://mc-stan.org/r-packages/\", getOption(\"repos\")))"},{"path":"http://steffilazerte.ca/bbsBayes/articles/bbsBayes.html","id":"install-cmdstan","dir":"Articles","previous_headings":"","what":"Install cmdstan","title":"Get Started","text":"Problems? Check cmdstanr’s vignette Getting Started","code":"cmdstanr::install_cmdstan()"},{"path":"http://steffilazerte.ca/bbsBayes/articles/bbsBayes.html","id":"check-cmdstanr-installation","dir":"Articles","previous_headings":"","what":"Check cmdstanr installation","title":"Get Started","text":"Useful include model runs reproducibility","code":"cmdstanr::cmdstan_path() #> [1] \"/home/runner/.cmdstan/cmdstan-2.30.1\" cmdstanr::cmdstan_version() #> [1] \"2.30.1\" library(bbsBayes) #> bbsBayes v3.0.0 #> Note: version 3+ represents a major shift in functionality, noteably: #>  - The underlying Bayesian modelling engine has switched from *JAGS* to *Stan* #>  - The workflow has been streamlined, resulting in many deprecated/renamed #>    function arguments #> See the documentation for more details: https://BrandonEdwards.github.io/bbsBayes"},{"path":"http://steffilazerte.ca/bbsBayes/articles/bbsBayes.html","id":"download-bbs-data","dir":"Articles","previous_headings":"","what":"Download BBS data","title":"Get Started","text":"Two levels state stop (state works bbsBayes models) Two releases 2020 2022","code":"fetch_bbs_data(force = TRUE) # Defaults to 2022 fetch_bbs_data(release = \"2020\", force = TRUE)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/bbsBayes.html","id":"stratify-the-data","dir":"Articles","previous_headings":"","what":"Stratify the data","title":"Get Started","text":"","code":"s <- stratify(by = \"bbs_usgs\", species = \"Snowy Owl\") #> Using 'bbs_usgs' (standard) stratification #> Loading BBS data... #> Filtering to species Snowy Owl (3760) #> Stratifying data... #>   Renaming routes... s <- stratify(by = \"bbs_usgs\", sample_data = TRUE) # Only Pacific Wren #> Using 'bbs_usgs' (standard) stratification #> Using sample BBS data... #> Using species Pacific Wren (sample data) #> Stratifying data... #>   Renaming routes..."},{"path":"http://steffilazerte.ca/bbsBayes/articles/bbsBayes.html","id":"prepare-the-data","dir":"Articles","previous_headings":"","what":"Prepare the data","title":"Get Started","text":"","code":"p <- prepare_data(s, min_max_route_years = 2)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/bbsBayes.html","id":"run-model","dir":"Articles","previous_headings":"","what":"Run model","title":"Get Started","text":"Super fast, just illustration","code":"m <- run_model(p, model = \"slope\",                iter_sampling = 10, iter_warmup = 10, chains = 2)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/bbsBayes.html","id":"look-at-the-model-outputs","dir":"Articles","previous_headings":"","what":"Look at the model outputs","title":"Get Started","text":"","code":"i <- generate_indices(model_output = m,                             regions = c(\"continental\",                                         \"national\",                                         \"prov_state\",                                         \"stratum\"))  tp <- plot_indices(indices = i, add_observed_means = TRUE)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/bbsBayes.html","id":"troubleshooting","dir":"Articles","previous_headings":"","what":"Troubleshooting","title":"Get Started","text":"","code":"Warning message: In fun(libname, pkgname) : rgeos: versions of GEOS runtime 3.10.2-CAPI-1.16.0 and GEOS at installation 3.8.0-CAPI-1.13.1differ pak::pkg_remove(\"rgeos\") pak::pkg_install(\"rgeos\")"},{"path":"http://steffilazerte.ca/bbsBayes/articles/stratification.html","id":"stratifying-with-existing-categories","dir":"Articles","previous_headings":"","what":"Stratifying with existing categories","title":"Stratification","text":"existing stratifications bbs_usgs, bbs_cws, bcr, latlong, prov_state can take look stratify data looking maps included bbsBayes load_map().  stratify BBS data, can use existing stratifications specifying = \"name\" stratify() function.","code":"ggplot(data = load_map(\"bbs_cws\"), aes(fill = strata_name)) +   geom_sf() +   scale_fill_viridis_d(guide = NULL) s <- stratify(by = \"bbs_usgs\", species = \"Canada Jay\") #> Using 'bbs_usgs' (standard) stratification #> Loading BBS data... #> Filtering to species Canada Jay (4840) #> Stratifying data... #>   Renaming routes..."},{"path":"http://steffilazerte.ca/bbsBayes/articles/stratification.html","id":"subsettin-an-existing-stratification","dir":"Articles","previous_headings":"","what":"Subsettin an existing stratification","title":"Stratification","text":"want use BBS CWS stratification, really want look Canadian regions? case ’ll subset BBS CWS stratification give stratify() data set addition specification. addition maps, stratifications available data frames bbs_strata object. can now modify use data frame like. Note stratification now “bbs_cws” “subset”","code":"names(bbs_strata) #> [1] \"bbs_usgs\"   \"bbs_cws\"    \"bcr\"        \"latlong\"    \"prov_state\" bbs_strata[[\"bbs_cws\"]] #> # A tibble: 207 × 7 #>    strata_name area_sq_km country country_code prov_state   bcr bcr_by_country #>  * <chr>            <dbl> <chr>   <chr>        <chr>      <dbl> <chr>          #>  1 CA-AB-10        52565. Canada  CA           AB            10 Canada-BCR_10  #>  2 CA-AB-11       149352. Canada  CA           AB            11 Canada-BCR_11  #>  3 CA-AB-6        445135. Canada  CA           AB             6 Canada-BCR_6   #>  4 CA-AB-8          6987. Canada  CA           AB             8 Canada-BCR_8   #>  5 CA-BC-10       383006. Canada  CA           BC            10 Canada-BCR_10  #>  6 CA-BC-4        193180. Canada  CA           BC             4 Canada-BCR_4   #>  7 CA-BC-5        199820. Canada  CA           BC             5 Canada-BCR_5   #>  8 CA-BC-6        106917. Canada  CA           BC             6 Canada-BCR_6   #>  9 CA-BC-9         59939. Canada  CA           BC             9 Canada-BCR_9   #> 10 CA-BCR7-7     1743744. Canada  CA           BCR7           7 Canada-BCR_7   #> # … with 197 more rows my_cws <- filter(bbs_strata[[\"bbs_cws\"]], country == \"United States of America\") s <- stratify(by = \"bbs_cws\", species = \"Canada Jay\", strata_custom = my_cws) #> Using 'bbs_cws' (subset) stratification #> Loading BBS data... #> Filtering to species Canada Jay (4840) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Omitting 18,093/119,567 routes that do not match a stratum... #>   Renaming routes... s$meta_data #> $stratify_by #> [1] \"bbs_cws\" #>  #> $stratify_type #> [1] \"subset\" #>  #> $species #> [1] \"Canada Jay\""},{"path":"http://steffilazerte.ca/bbsBayes/articles/stratification.html","id":"custom-stratification---new-map","dir":"Articles","previous_headings":"","what":"Custom stratification - New map","title":"Stratification","text":"define completely different stratification, ’ll need provide spatial data object polygons defining strata. example ’ll use WBPHS stratum boundaries 2019. available available US Fish Wildlife Service Catalogue: https://ecos.fws.gov/ServCat/Reference/Profile/142628 can either download hand, following code. use file bbsBayes, need load sf object using sf package.  see one column reflects stratum names. First ’ll rename column strata_name stratify() requires. Now spatial data relevant information pass stratify(). using custom stratification, argument becomes name want apply. Let’s use something informative, short (although ’s limit). also need give function map. Note strata names automatically put lower case consistency. can take quick look output, looking meta data routes contained therein. get different look can also plot data top map using ggplot2. Note use factor() ensure stratum names categorical.  Based message received stratification map, looks custom stratification excluding BBS data. Let’s see looks like comparing raw BBS data. First load raw routes data, ’ll add plot. plot may take little run!  can clearly see, spatially, points omitted data.","code":"z <- \"WBPHS_stratum_boundaries_2019.zip\"  download.file(url = \"https://ecos.fws.gov/ServCat/DownloadFile/213149\",               destfile = z) unzip(z) unlink(z) map <- sf::read_sf(\"WBPHS_stratum_boundaries_2019.shp\") map #> Simple feature collection with 81 features and 1 field #> Geometry type: POLYGON #> Dimension:     XY #> Bounding box:  xmin: -166.8897 ymin: 41.95304 xmax: -52.61347 ymax: 70.26563 #> Geodetic CRS:  WGS 84 #> # A tibble: 81 × 2 #>    STRAT                                                                geometry #>    <int>                                                           <POLYGON [°]> #>  1    10 ((-165.2478 65.9118, -165.4129 65.9136, -165.5941 65.92889, -165.7198 … #>  2    10 ((-165.666 65.21061, -165.6339 65.226, -165.5973 65.22971, -165.534 65… #>  3    11 ((-159.1616 66.1132, -159.2357 66.1137, -159.2907 66.1165, -159.3785 6… #>  4     9 ((-161.8425 59.61546, -161.8578 59.61984, -161.8837 59.63493, -161.907… #>  5    10 ((-162.0134 64.7124, -162.049 64.71309, -162.0833 64.71751, -162.1213 … #>  6    10 ((-160.881 64.70971, -160.9209 64.7151, -160.9496 64.73389, -160.9629 … #>  7     6 ((-158.4808 64.28549, -158.5828 64.2881, -158.6513 64.29482, -158.7074… #>  8     5 ((-159.7113 61.94699, -159.7341 61.9489, -159.7628 61.95391, -159.8032… #>  9     3 ((-153.8148 64.6944, -153.8857 64.6792, -153.9843 64.65071, -154.1057 … #> 10     4 ((-144.2179 65.86969, -144.3817 65.87701, -144.4698 65.88491, -144.537… #> # … with 71 more rows ggplot(map, aes(fill = factor(STRAT))) +    geom_sf() +   scale_fill_viridis_d(guide = NULL) map <- rename(map, strata_name = STRAT) map #> Simple feature collection with 81 features and 1 field #> Geometry type: POLYGON #> Dimension:     XY #> Bounding box:  xmin: -166.8897 ymin: 41.95304 xmax: -52.61347 ymax: 70.26563 #> Geodetic CRS:  WGS 84 #> # A tibble: 81 × 2 #>    strata_name                                                          geometry #>          <int>                                                     <POLYGON [°]> #>  1          10 ((-165.2478 65.9118, -165.4129 65.9136, -165.5941 65.92889, -165… #>  2          10 ((-165.666 65.21061, -165.6339 65.226, -165.5973 65.22971, -165.… #>  3          11 ((-159.1616 66.1132, -159.2357 66.1137, -159.2907 66.1165, -159.… #>  4           9 ((-161.8425 59.61546, -161.8578 59.61984, -161.8837 59.63493, -1… #>  5          10 ((-162.0134 64.7124, -162.049 64.71309, -162.0833 64.71751, -162… #>  6          10 ((-160.881 64.70971, -160.9209 64.7151, -160.9496 64.73389, -160… #>  7           6 ((-158.4808 64.28549, -158.5828 64.2881, -158.6513 64.29482, -15… #>  8           5 ((-159.7113 61.94699, -159.7341 61.9489, -159.7628 61.95391, -15… #>  9           3 ((-153.8148 64.6944, -153.8857 64.6792, -153.9843 64.65071, -154… #> 10           4 ((-144.2179 65.86969, -144.3817 65.87701, -144.4698 65.88491, -1… #> # … with 71 more rows s <- stratify(by = \"WBPHS_2019\", species = \"Canada Jay\", strata_custom = map) #> Using 'wbphs_2019' (custom) stratification #> Loading BBS data... #> Filtering to species Canada Jay (4840) #> Stratifying data... #> Preparing custom strata (EPSG:4326; WGS 84)... #>   Summarizing strata... #>   Calculating area weights... #>   Joining routes to custom spatial data... #>   Omitting 100,155/119,567 routes that do not match a stratum... #>   Renaming routes... s[[\"meta_data\"]] #> $stratify_by #> [1] \"wbphs_2019\" #>  #> $stratify_type #> [1] \"custom\" #>  #> $species #> [1] \"Canada Jay\" s[[\"routes_strata\"]] #> # A tibble: 19,412 × 33 #>    strata_n…¹ count…² state…³ route route…⁴ active latit…⁵ longi…⁶   bcr route…⁷ #>    <chr>        <dbl>   <dbl> <chr> <chr>    <dbl>   <dbl>   <dbl> <dbl>   <dbl> #>  1 3              840       3 3-8   TOWER …      1    63.6   -144.     4       1 #>  2 3              840       3 3-8   TOWER …      1    63.6   -144.     4       1 #>  3 3              840       3 3-8   TOWER …      1    63.6   -144.     4       1 #>  4 3              840       3 3-8   TOWER …      1    63.6   -144.     4       1 #>  5 3              840       3 3-8   TOWER …      1    63.6   -144.     4       1 #>  6 3              840       3 3-8   TOWER …      1    63.6   -144.     4       1 #>  7 3              840       3 3-8   TOWER …      1    63.6   -144.     4       1 #>  8 3              840       3 3-8   TOWER …      1    63.6   -144.     4       1 #>  9 3              840       3 3-8   TOWER …      1    63.6   -144.     4       1 #> 10 3              840       3 3-8   TOWER …      1    63.6   -144.     4       1 #> # … with 19,402 more rows, 23 more variables: route_type_detail_id <dbl>, #> #   route_data_id <dbl>, rpid <dbl>, year <dbl>, month <dbl>, day <dbl>, #> #   obs_n <dbl>, total_spp <dbl>, start_temp <dbl>, end_temp <dbl>, #> #   temp_scale <chr>, start_wind <dbl>, end_wind <dbl>, start_sky <dbl>, #> #   end_sky <dbl>, start_time <dbl>, end_time <dbl>, assistant <dbl>, #> #   quality_current_id <dbl>, run_type <dbl>, state <chr>, st_abrev <chr>, #> #   country <chr>, and abbreviated variable names ¹​strata_name, ²​country_num, … r <- s[[\"routes_strata\"]] %>%   st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326)  ggplot() +   geom_sf(data = map, aes(fill = factor(strata_name)), alpha = 0.3) +   geom_sf(data = r, aes(colour = factor(strata_name)), size = 1) +   scale_fill_viridis_d(aesthetics = c(\"colour\", \"fill\"), guide = NULL) bbs_routes <- load_bbs_data()[[\"routes\"]] %>%   st_as_sf(coords = c(\"longitude\", \"latitude\"), crs= 4326)  ggplot() +   geom_sf(data = map, aes(fill = factor(strata_name)), alpha = 0.3) +   geom_sf(data = r, aes(colour = factor(strata_name)), size = 1) +   geom_sf(data = bbs_routes, size = 0.5) +   scale_fill_viridis_d(aesthetics = c(\"colour\", \"fill\"), guide = NULL)"},{"path":"http://steffilazerte.ca/bbsBayes/articles/stratification.html","id":"custom-stratification---modifying-existing-bbs-maps","dir":"Articles","previous_headings":"","what":"Custom stratification - Modifying existing BBS maps","title":"Stratification","text":"Stratify custom stratification, using sf map object e.g, east/west divide southern Canada BBS CWS strata First ’ll start CWS BBS data ’ll modify first looking provinces (omitting northern territories), transforming GPS CRS (4326), ensuring resulting polygons valid. Now can crop map make western eastern portion, defined longitude latitude (first transformed GPS CRS). Now ’ll bind together transform back original CRS  Looks good! Let’s use stratification take look points afterwards ensure ’ve categorized appropriately.  Now ’re good continue prepare_data()…","code":"map <- load_map(\"bbs_cws\") new_map <- map %>%   filter(country_code == \"CA\", !prov_state %in% c(\"NT\", \"NU\", \"YT\")) %>%   st_transform(4326) %>%   st_make_valid() west <- st_crop(new_map, xmin = -140, ymin = 42, xmax = -95, ymax = 68) %>%   mutate(strata_name = \"west\") #> Warning: attribute variables are assumed to be spatially constant throughout all #> geometries east <- st_crop(new_map, xmin = -95, ymin = 42, xmax = -52, ymax = 68) %>%   mutate(strata_name = \"east\") #> Warning: attribute variables are assumed to be spatially constant throughout all #> geometries new_strata <- bind_rows(west, east) %>%   st_transform(st_crs(map))  ggplot() +   geom_sf(data = map) +   geom_sf(data = new_strata, aes(fill = strata_name), alpha = 1) s <- stratify(by = \"canada_ew\", species = \"Canada Jay\",                strata_custom = new_strata) #> Using 'canada_ew' (custom) stratification #> Loading BBS data... #> Filtering to species Canada Jay (4840) #> Stratifying data... #> Preparing custom strata (ESRI:102008; North_America_Albers_Equal_Area_Conic)... #>   Summarizing strata... #>   Calculating area weights... #>   Joining routes to custom spatial data... #>   Omitting 103,468/119,567 routes that do not match a stratum... #>   Renaming routes...  s$meta_data #> $stratify_by #> [1] \"canada_ew\" #>  #> $stratify_type #> [1] \"custom\" #>  #> $species #> [1] \"Canada Jay\" routes <- s$routes_strata %>%   st_as_sf(coords = c(\"longitude\", \"latitude\"), crs = 4326)  ggplot() +   geom_sf(data = new_strata, aes(fill = strata_name), alpha = 1) +   geom_sf(data = routes, aes(shape = strata_name))"},{"path":"http://steffilazerte.ca/bbsBayes/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Brandon P.M. Edwards. Author, maintainer. Adam C. Smith. Author. Steffi LaZerte. Author.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Edwards, B.P.M .C. Smith. (2021). bbsBayes: R Package Hierarchical Bayesian Analysis North American Breeding Bird Survey Data. Journal Open Research Software 9(1), p.19. https://doi.org/10.5334/jors.329 Pardieck, K.L., Ziolkowski Jr., D.J., Lutmerding, M., Aponte, V.., Hudson, M-.R., 2020, North American Breeding Bird Survey Dataset 1966 - 2019: U.S. Geological Survey data release, https://doi.org/10.5066/P9J6QUF6.","code":"@Article{,   title = {bbsBayes: An R Package for Hierarchical Bayesian Analysis of North American Breeding Bird Survey Data},   year = {2021},   journal = {Journal of Open Research Software},   volume = {9},   issue = {1},   url = {https://doi.org/10.5334/jors.329},   author = {{Edwards} and Brandon PM and {Smith} and Adam C}, } @Misc{,   title = {North American Breeding Bird Survey Dataset 1966 - 2019},   version = {2020},   publisher = {U.S. Geological Survey, Patuxent Wildlife Research Center.},   author = {{Pardieck} and Keith L. and {Ziolkowski Jr.} and Dave J. and {Lutmerding} and {M.} and {Aponte} and {Veronica} and {Hudson} and Marie-Anne R.}, }"},{"path":"http://steffilazerte.ca/bbsBayes/index.html","id":"bbsbayes-","dir":"","previous_headings":"","what":"Hierarchical Bayesian Analysis of North American BBS Data","title":"Hierarchical Bayesian Analysis of North American BBS Data","text":"README file provides overview functionality can accomplished ‘bbsBayes’. intended provide enough information users perform, least, replications status trend estimates Canadian Wildlife Service /United States Geological Survey. However, provides -depth advanced examples subsetting data, custom regional summaries, . Additional resources: * Introductory bbsBayes Workshop * Journal Article worked example","code":""},{"path":"http://steffilazerte.ca/bbsBayes/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Hierarchical Bayesian Analysis of North American BBS Data","text":"bbsBayes package perform hierarchical Bayesian analysis North American Breeding Bird Survey (BBS) data. ‘bbsBayes’ run full model analysis one species choose, can take control specify data stratified, prepared Stan, modelled.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Hierarchical Bayesian Analysis of North American BBS Data","text":"Option 1: Stable release CRAN Option 2: Less-stable development version","code":"# To install from CRAN: install.packages(\"bbsBayes\") # To install the development version from GitHub: install.packages(\"devtools\") library(devtools) devtools::install_github(\"BrandonEdwards/bbsBayes\")"},{"path":"http://steffilazerte.ca/bbsBayes/reference/assign_prov_state.html","id":null,"dir":"Reference","previous_headings":"","what":"Categorize polygon by Province/State if applicable — assign_prov_state","title":"Categorize polygon by Province/State if applicable — assign_prov_state","text":"Categorize polygon Province/State applicable","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/assign_prov_state.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Categorize polygon by Province/State if applicable — assign_prov_state","text":"","code":"assign_prov_state(   strata_map,   min_overlap = 0.75,   plot = FALSE,   keep_spatial = TRUE )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/assign_prov_state.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Categorize polygon by Province/State if applicable — assign_prov_state","text":"strata_map sf data frame. Strata polygons categorized. min_overlap Numeric. minimum proportion overlap stratum polygon Province State. raise warnings. plot Logical. Whether plot polygons assigned Provinces States keep_spatial Logical. Whether output spatial data frame .","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/assign_prov_state.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Categorize polygon by Province/State if applicable — assign_prov_state","text":"(Spatial) data frame strata assigned Province/State","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/assign_prov_state.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Categorize polygon by Province/State if applicable — assign_prov_state","text":"","code":"# Demonstration of why we can't divide BCR by Provinces and States! map <- load_map(\"bcr\") assign_prov_state(map, plot = TRUE) #> Error in stopifnot(!inherits(x, \"sf\"), !missing(sf_column_name), !missing(agr)): Problem while computing `prov_state = if_else(.data$prov_state == \"NF\", #> \"NL\", .data$prov_state)`. #> Caused by error in `if_else()`: #> ! could not find function \"if_else\"  # Use custom stratification, using sf map object # e.g. with WBPHS stratum boundaries 2019 # available: https://ecos.fws.gov/ServCat/Reference/Profile/142628  if (FALSE) { map <- sf::read_sf(\"../WBPHS_Stratum_Boundaries_2019\") %>%   rename(strata_name = STRAT) # expects this column s <- assign_prov_state(map, plot = TRUE) # Some don't divide nicely, we could try a different min_overlap  s <- assign_prov_state(map, min_overlap = 0.6, plot = TRUE) }"},{"path":[]},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbsBayes-defunct.html","id":"superseded","dir":"Reference","previous_headings":"","what":"Superseded","title":"bbsBayes defunct functions — bbsBayes-defunct","text":"generate_indices() supersedes generate_cont_indices() generate_regional_indices() generate_strata_indices() generate_trends() supersedes generate_cont_trend() generate_regional_trends() generate_strata_trends() plot_indices() supersedes plot_cont_indices() prepare_data() supersedes prepare_jags_data()","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbsBayes-defunct.html","id":"no-longer-relevant","dir":"Reference","previous_headings":"","what":"No longer relevant","title":"bbsBayes defunct functions — bbsBayes-defunct","text":"get_prepared_data() longer required. Access raw_data list item output prepare_data(). e.g., prepped_data[[\"raw_data\"]] get_mcmc_list() longer required (relevant). Access model_fit list item output run_model() cmdstanr model object. e.g., model_output[[\"model_fit\"]] get_final_values() longer required. Use cmdstanr::draws() extract final samples model_fit list item output run_model(). e.g., model_output[[\"model_fit\"]]$draws() get_strata_area() get_composite_regions() longer required. Access strata areas regional data exploring included data bbs_strata. e.g, `bbs_strata[\"bbs_usgs\"]. p_waic() waic() longer recommended BBS data. Use cross validation instead extract_index_data() longer recommended.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbsBayes-defunct.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"bbsBayes defunct functions — bbsBayes-defunct","text":"","code":"generate_cont_indices(...)  generate_regional_indices(...)  generate_strata_indices(...)  generate_cont_trend(...)  generate_regional_trends(...)  generate_strata_trends(...)  get_final_values(...)  get_mcmc_list(...)  extract_index_data(...)  get_prepared_data(...)  get_strata_area(...)  get_composite_regions(...)  plot_cont_indices(...)  prepare_jags_data(...)  p_waic(...)  waic(...)"},{"path":[]},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbsBayes-deprecated.html","id":null,"dir":"Reference","previous_headings":"","what":"bbsBayes deprecated functions — bbsBayes-deprecated","title":"bbsBayes deprecated functions — bbsBayes-deprecated","text":"plot_map() supersedes generate_map() plot_geofacet() supersedes geofacet_plot()","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbsBayes-deprecated.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"bbsBayes deprecated functions — bbsBayes-deprecated","text":"","code":"generate_map(...)  geofacet_plot(..)"},{"path":[]},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbsBayes-package.html","id":null,"dir":"Reference","previous_headings":"","what":"bbsBayes: Hierarchical Bayesian Analysis of North American BBS Data — bbsBayes-package","title":"bbsBayes: Hierarchical Bayesian Analysis of North American BBS Data — bbsBayes-package","text":"North American Breeding Bird Survey (BBS) long-running program seeks monitor status trends breeding birds North America. Since start 1966, BBS accumulated 50 years data 500 species North American Birds. Given temporal spatial structure data, hierarchical Bayesian models used assess status trends 500+ species birds. 'bbsBayes' allows perform hierarchical Bayesian analysis BBS data. can run full model analysis one species choose, can take control specify data stratified, prepared 'JAGS', modelled. functions provided allow replicate analyses performed United State Geological Survey (USGS, see Link Sauer (2011) doi:10.1525/auk.2010.09220 ) Canadian Wildlife Service (CWS, see Smith Edwards (2020) doi:10.1101/2020.03.26.010215 ).","code":""},{"path":[]},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbsBayes-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"bbsBayes: Hierarchical Bayesian Analysis of North American BBS Data — bbsBayes-package","text":"Maintainer: Brandon P.M. Edwards brandonedwards3@cmail.carleton.ca Authors: Adam C. Smith adam.smith2@canada.ca Steffi LaZerte steffi@steffi.ca","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbs_data_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample BBS data — bbs_data_sample","title":"Sample BBS data — bbs_data_sample","text":"Contains Pacific Wren data","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbs_data_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample BBS data — bbs_data_sample","text":"","code":"bbs_data_sample"},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbs_data_sample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sample BBS data — bbs_data_sample","text":"object class list length 3.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbs_models.html","id":null,"dir":"Reference","previous_headings":"","what":"List of models available — bbs_models","title":"List of models available — bbs_models","text":"List models available","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbs_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List of models available — bbs_models","text":"","code":"bbs_models"},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbs_models.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"List of models available — bbs_models","text":"object class tbl_df (inherits tbl, data.frame) 9 rows 3 columns.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbs_strata.html","id":null,"dir":"Reference","previous_headings":"","what":"List of established strata — bbs_strata","title":"List of established strata — bbs_strata","text":"list item contains data frame describing strata stratification.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbs_strata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"List of established strata — bbs_strata","text":"","code":"bbs_strata"},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbs_strata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"List of established strata — bbs_strata","text":"object class list length 5.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bbs_strata.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"List of established strata — bbs_strata","text":"Contains bbs_usgs, bbs_cws, bcr, latlong prov_state","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bird_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample point count data per species (Pacific Wren only) — bird_sample","title":"Sample point count data per species (Pacific Wren only) — bird_sample","text":"sample dataset containing 10-stop counts bird species seen per route per year. NOTE: contains data Pacific Wren, full data set. full count set obtained via function fetch_bbs_data. data obtained United States Geological Survey subject change new data added year. See Details citation.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bird_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample point count data per species (Pacific Wren only) — bird_sample","text":"","code":"bird_sample"},{"path":"http://steffilazerte.ca/bbsBayes/reference/bird_sample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sample point count data per species (Pacific Wren only) — bird_sample","text":"object class data.frame 5243 rows 15 columns.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/bird_sample.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sample point count data per species (Pacific Wren only) — bird_sample","text":"Pardieck, K.L., D.J. Ziolkowski Jr., M. Lutmerding, V. Aponte M-.R. Hudson. 2019. North American Breeding Bird Survey Dataset 1966 - 2018, version 2018.0. U.S. Geological Survey, Patuxent Wildlife Research Center. https://doi.org/10.5066/P9HE8XYJ.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/common_docs.html","id":null,"dir":"Reference","previous_headings":"","what":"Common arguments and documentation for various functions — common_docs","title":"Common arguments and documentation for various functions — common_docs","text":"Common arguments documentation various functions","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/common_docs.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Common arguments and documentation for various functions — common_docs","text":"level Character. type BBS counts fetch, \"state\" \"stop\". Defaults \"state\". release Numeric. Yearly release. Options 2022 (default including data 2021 field season) 2020 (including data 2019) sf Spatial data frame. PLACEHOLDER model_output List. Output run_model(). quiet Logical. Suppress progress messages? Default FALSE min_year Numeric. Minimum year use. Default (NULL) uses first year data. max_year Numeric. Maximum year use. Default (NULL) uses first year data. indices List. Indices generated generate_indices() prepped_data List. Output prepare_data(). Use @inheritParams common_docs include function documentation matching argument (include matching args)","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/common_docs.html","id":"naturecounts-account","dir":"Reference","previous_headings":"","what":"NatureCounts account","title":"Common arguments and documentation for various functions — common_docs","text":"public data available username/password (sign free NatureCounts account). However, access private/semi-public projects/collections must request access. See Access request_ids section information.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/convergence.html","id":null,"dir":"Reference","previous_headings":"","what":"Convergence metrics — convergence","title":"Convergence metrics — convergence","text":"Convergence metrics","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/convergence.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convergence metrics — convergence","text":"","code":"convergence(model_output)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/convergence.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convergence metrics — convergence","text":"model_output List. Output run_model().","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/convergence.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convergence metrics — convergence","text":"Data frame convergence metrics","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/convergence.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convergence metrics — convergence","text":"","code":"# \\donttest{ # Toy example with Pacific Wren sample data # First, stratify the sample data s <- stratify(by = \"bbs_cws\", sample_data = TRUE) #> Using 'bbs_cws' (standard) stratification #> Using sample BBS data... #> Using species Pacific Wren (sample data) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Renaming routes...  # Prepare the stratified data for use in modelling d <- prepare_data(s, min_year = 2009, max_year = 2018)  # Now run the model (fast but not good, just for illustration) m <- run_model(d, model = \"first_diff\",                iter_sampling = 20, iter_warmup = 20, chains = 2) #> Running MCMC with 2 chains, at most 4 in parallel... #>  #> Chain 1 WARNING: There aren't enough warmup iterations to fit the  #> Chain 1          three stages of adaptation as currently configured.  #> Chain 1          Reducing each adaptation stage to 15%/75%/10% of  #> Chain 1          the given number of warmup iterations:  #> Chain 1            init_buffer = 3  #> Chain 1            adapt_window = 15  #> Chain 1            term_buffer = 2  #> Chain 1 Iteration:  1 / 40 [  2%]  (Warmup)  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 2 WARNING: There aren't enough warmup iterations to fit the  #> Chain 2          three stages of adaptation as currently configured.  #> Chain 2          Reducing each adaptation stage to 15%/75%/10% of  #> Chain 2          the given number of warmup iterations:  #> Chain 2            init_buffer = 3  #> Chain 2            adapt_window = 15  #> Chain 2            term_buffer = 2  #> Chain 2 Iteration:  1 / 40 [  2%]  (Warmup)  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Log location parameter[1] is inf, but must be finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 1 Iteration: 21 / 40 [ 52%]  (Sampling)  #> Chain 2 Iteration: 21 / 40 [ 52%]  (Sampling)  #> Chain 1 Iteration: 40 / 40 [100%]  (Sampling)  #> Chain 2 Iteration: 40 / 40 [100%]  (Sampling)  #> Chain 1 finished in 25.1 seconds. #> Chain 2 finished in 25.7 seconds. #>  #> Both chains finished successfully. #> Mean chain execution time: 25.4 seconds. #> Total execution time: 25.9 seconds. #>  #> Saving model output to /home/runner/work/bbsBayes/bbsBayes/docs/reference/BBS_STAN_first_diff_hier_2022-11-10_01.rds  # Calculate convergence metrics on each variable conv <- convergence(m) #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. #> Warning: The ESS has been capped to avoid unstable estimates. # }"},{"path":"http://steffilazerte.ca/bbsBayes/reference/fetch_bbs_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch Breeding Bird Survey dataset (TIDY) — fetch_bbs_data","title":"Fetch Breeding Bird Survey dataset (TIDY) — fetch_bbs_data","text":"Use File Transfer Protocol (FTP) fetch Breeding Bird Survey data United States Geological Survey (USGS) FTP site. raw data uploaded site analyses performed. package-specific directory created user's computer (see documentation rappdirs::appdir details directory lives), BBS data saved directory use functions. downloading data, user must thoroughly read terms conditions user data type word \"yes\" agree.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/fetch_bbs_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch Breeding Bird Survey dataset (TIDY) — fetch_bbs_data","text":"","code":"fetch_bbs_data(   level = \"state\",   release = 2022,   force = FALSE,   quiet = FALSE,   compression = \"none\" )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/fetch_bbs_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch Breeding Bird Survey dataset (TIDY) — fetch_bbs_data","text":"level Character. type BBS counts fetch, \"state\" \"stop\". Defaults \"state\". release Numeric. Yearly release. Options 2022 (default including data 2021 field season) 2020 (including data 2019) force Logical. pre-exising BBS data overwritten? Defaults FALSE quiet Logical. Suppress progress messages? Default FALSE compression Character. compression used save data? Defaults none takes space fastest load. Must one none, gz, bz2, xz (passed readr::write_rds()'s compress argument).","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/fetch_bbs_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fetch Breeding Bird Survey dataset (TIDY) — fetch_bbs_data","text":"BBS state level counts provide counts beginning 1966, aggregated five bins, contains cumulative counts 10 50 stops along route. contrats BBS stop level counts provides stop-level data beginning 1997, includes counts stop along routes individually. Note stop-level data currently supported modelling utilities bbsBayes.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/fetch_bbs_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fetch Breeding Bird Survey dataset (TIDY) — fetch_bbs_data","text":"","code":"if (FALSE) { # interactive()  fetch_bbs_data(force = TRUE) fetch_bbs_data(level = \"stop\", force = TRUE) fetch_bbs_data(release = 2020, force = TRUE) fetch_bbs_data(release = 2020, level = \"stop\", force = TRUE) }"},{"path":"http://steffilazerte.ca/bbsBayes/reference/fetch_bbs_data_orig.html","id":null,"dir":"Reference","previous_headings":"","what":"Fetch Breeding Bird Survey dataset — fetch_bbs_data_orig","title":"Fetch Breeding Bird Survey dataset — fetch_bbs_data_orig","text":"fetch_bbs_data uses File Transfer Protocol (FTP) fetch Breeding Bird Survey data United States Geological Survey (USGS) FTP site. raw data uploaded site analyses performed. package-specific directory created user's computer (see documentation rappdirs::appdir details directory lives), BBS data saved directory use functions. downloading data, user must thoroughly read terms conditions user data type word \"yes\" agree.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/fetch_bbs_data_orig.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fetch Breeding Bird Survey dataset — fetch_bbs_data_orig","text":"","code":"fetch_bbs_data_orig(   level = \"state\",   release = 2022,   quiet = FALSE,   force = FALSE )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/fetch_bbs_data_orig.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fetch Breeding Bird Survey dataset — fetch_bbs_data_orig","text":"level string, either \"state\" \"stop\", specifying counts fetch. Defaults \"state\", provides counts beginning 1966, aggregated five bins, contains cumulative counts 10 50 stops along route. Specifying \"stop\" provides stop-level data beginning 1997, includes counts stop along routes individually. Note stop-level data currently supported modeling utilities bbsBayes. release Integer: yearly release desired? options 2022 (default including data 2021 field season) 2020 (including data 2019) quiet Logical: progress bars suppressed? Defaults FALSE force Logical: BBS data already exists computer, overwritten? Defaults FALSE","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/fetch_bbs_data_orig.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fetch Breeding Bird Survey dataset — fetch_bbs_data_orig","text":"None","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Regional annual indices of abundance — generate_indices","title":"Regional annual indices of abundance — generate_indices","text":"Calculate annual indices relative abundance year different regions. indices can used plot population trajectories species, estimate trends.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_indices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regional annual indices of abundance — generate_indices","text":"","code":"generate_indices(   model_output = NULL,   quantiles = c(0.025, 0.05, 0.25, 0.75, 0.95, 0.975),   regions = c(\"stratum\", \"continent\"),   regions_index = NULL,   alternate_n = \"n\",   start_year = NULL,   drop_exclude = FALSE,   max_backcast = NULL,   quiet = FALSE,   jags_mod,   jags_data,   alt_region_names,   startyear )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_indices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regional annual indices of abundance — generate_indices","text":"model_output List. Output run_model(). quantiles vector quantiles sampled posterior distribution Defaults c(0.025,0.05,0.25,0.5,0.75,0.95,0.975) regions vector selecting regional compilation(s) calculate. Default \"continent\" \"stratum\". Options also include \"country\", \"prov_state\", \"bcr\", \"bcr_by_country\" stratifications include areas align regions. regions_index Data frame. Index strata line regions. alternate_n text string indicating name alternative annual index parameter model, Default \"n\", alternatives \"n2\" involves different way scaling annual indices, \"nsmooth\" gam gamye models show smooth component trajectory, \"nslope\" slope models track linear slope component model start_year Optional first year calculate annual indices trajectory recent portion time series desired. probably relevant max_backcast set trajectories different time-periods include different subset strata (.e., strata removed) drop_exclude logical indicating strata exceed max_backcast threshold excluded calculations, Default FALSE (regions flagged listed dropped) max_backcast optional integer indicating maximum number years backcast stratum-level estimates first year species observed route stratum. 5 used CWS national estimates. observed data given stratum include least one non-zero observation species first year BBS start_year+max_backcast, stratum flagged within relevant regional summary. Default value, NULL ignores backcasting limit (.e., generates annual indices entire time series, regardless species first observed) quiet Logical. Suppress progress messages? Default FALSE jags_mod Defunct. Use model_output instead jags_data Defunct. alt_region_names Defunct. Use regions_index instead startyear Deprecated. Use start_year instead","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_indices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regional annual indices of abundance — generate_indices","text":"List 6 objects data_summary dataframe following columns Year Year particular index Region Region name Region_alt Long name region Region_type Type region including continental, national,Province_State,BCR, bcr_by_country, stratum Strata_included Strata included annual index calculations Strata_excluded Strata potentially excluded annual index calculations observations species first part time series, see arguments max_backcast start_year Index Strata-weighted count index additional columns values quantiles quantiles posterior distribution obs_mean Mean observed annual counts birds across routes years. alternative estimate average relative abundance species region year. Differences annual indices function model. composite regions (.e., anything stratum-level estimates) average count calculated area-weighted average across strata included nrts Number BBS routes contributed data species, region, year nrts_total Number BBS routes contributed data species region years selected time-series, .e., years since start_year nnzero Number BBS routes species observed (.e., count > 0) region year backcast_flag approximate annual average proportion covered species range free extrapolated population trajectories. e.g., 1.0 = data cover full time-series, 0.75 = data cover 75 percent time-series. calculated max_backcast != NULL samples array posterior draws area-weights data frame strata names area weights used calculate continental estimates y_min first year used summary, scale 1:length time-series y_max last year used summary, scale 1:length time-series start_year first year used summary, scale 1966:2018","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_indices.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Regional annual indices of abundance — generate_indices","text":"","code":"# Toy example with Pacific Wren sample data # First, stratify the sample data s <- stratify(by = \"bbs_cws\", sample_data = TRUE) #> Using 'bbs_cws' (standard) stratification #> Using sample BBS data... #> Using species Pacific Wren (sample data) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Renaming routes...  # Prepare the stratified data for use in modelling d <- prepare_data(s,                   min_year = 2009,                   max_year = 2018)  # Now run the model (fast but not good, just for illustration) m <- run_model(d, model = \"first_diff\",                iter_sampling = 20, iter_warmup = 20, chains = 2) #> Running MCMC with 2 chains, at most 4 in parallel... #>  #> Chain 1 WARNING: There aren't enough warmup iterations to fit the  #> Chain 1          three stages of adaptation as currently configured.  #> Chain 1          Reducing each adaptation stage to 15%/75%/10% of  #> Chain 1          the given number of warmup iterations:  #> Chain 1            init_buffer = 3  #> Chain 1            adapt_window = 15  #> Chain 1            term_buffer = 2  #> Chain 1 Iteration:  1 / 40 [  2%]  (Warmup)  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 2 WARNING: There aren't enough warmup iterations to fit the  #> Chain 2          three stages of adaptation as currently configured.  #> Chain 2          Reducing each adaptation stage to 15%/75%/10% of  #> Chain 2          the given number of warmup iterations:  #> Chain 2            init_buffer = 3  #> Chain 2            adapt_window = 15  #> Chain 2            term_buffer = 2  #> Chain 2 Iteration:  1 / 40 [  2%]  (Warmup)  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 1 Iteration: 21 / 40 [ 52%]  (Sampling)  #> Chain 2 Iteration: 21 / 40 [ 52%]  (Sampling)  #> Chain 2 Iteration: 40 / 40 [100%]  (Sampling)  #> Chain 1 Iteration: 40 / 40 [100%]  (Sampling)  #> Chain 2 finished in 55.3 seconds. #> Chain 1 finished in 55.7 seconds. #>  #> Both chains finished successfully. #> Mean chain execution time: 55.5 seconds. #> Total execution time: 55.8 seconds. #>  #> Saving model output to /home/runner/work/bbsBayes/bbsBayes/docs/reference/BBS_STAN_first_diff_hier_2022-11-10_01.rds  # Generate the continental and stratum indices i <- generate_indices(model_output = m) #> Processing region stratum #> Processing region continent  # Generate only country indices i_nat <- generate_indices(model_output = m, regions = \"country\") #> Processing region country"},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_trends.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate regional trends — generate_trends","title":"Generate regional trends — generate_trends","text":"Generates trends continent strata optionally countries, states/provinces, BCRs analyses run stratifications support composite regions. Calculates geometric mean annual changes population size composite regions.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_trends.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate regional trends — generate_trends","text":"","code":"generate_trends(   indices,   min_year = NULL,   max_year = NULL,   quantiles = c(0.025, 0.05, 0.25, 0.75, 0.95, 0.975),   slope = FALSE,   prob_decrease = NULL,   prob_increase = NULL,   Min_year,   Max_year )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_trends.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate regional trends — generate_trends","text":"indices List. Indices generated generate_indices() min_year Numeric. Minimum year use. Default (NULL) uses first year data. max_year Numeric. Maximum year use. Default (NULL) uses first year data. quantiles Numeric vector. Quantiles sampled posterior distribution. Defaults c(0.025, 0.05, 0.25, 0.5, 0.75, 0.95, 0.975) slope Logical. Whether calculate alternative trend metric, slope log-linear regression annual indices. Default FALSE. prob_decrease Numeric vector. Percent-decrease values optionally calculate posterior probabilities (see Details). Default NULL (calculate). prob_increase Numeric vector. Percent-increase values optionally calculate posterior probabilities (see Details). Default NULL (calculate). Min_year Deprecated. Use min_year instead Max_year Deprecated. Use max_year instead","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_trends.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate regional trends — generate_trends","text":"Data frame one row region included starting indices object. Contains start_year, end_year, region, region-alt, region_type, strata_included, strata_excluded Start_year first year trend End_year last year trend Region short name region Region_alt Long name region Region_type Type region including continental, national,Province_State,BCR, bcr_by_national, stratum Strata_included Strata included trend annual index calculations Strata_excluded Strata potentially excluded trend annual index calculations observations species first part time series Trend Estimated mean annual percent change trend time-period (.e., Start_year - End_year), according endpoint comparison annual index Start_year annual index End_year Trend_Q_quantiles quantiles posterior distribution Trend estimates, matching levels included quantiles argument Percent_Change Estimated total percent change trend time-period Percent_Change_Q_quantiles quantiles posterior distribution Percent Change estimates, matching levels included quantiles argument Slope_Trend Estimated mean annual percent change trend time-period, according slope linear regression log-transformed annual indices Slope_Trend_Q_quantiles quantiles posterior distribution Percent Change estimates, matching levels included quantiles argument prob_decrease_X_percent proportion posterior distribution Percent_Change percentage values supplied prob_decrease prob_increase_X_percent proportion posterior distribution Percent_Change percentage values supplied prob_increase Relative_Abundance Mean annual index values across years. estimate average relative abundance species region. Can interepreted predicted average count species average year average route average observer, years, routes, observers existing data Observed_Relative_Abundance Mean observed annual counts birds across routes years. alternative estimate average relative abundance species region. composite regions (.e., anything stratum-level estimates) average count calculated area-weighted average across strata included Number_of_Strata number strata included region Width_of_X_percent_Credible_Interval Width (percent/year) credible interval Trend calculation. Calculated widest credible interval requested quantiles argument. Default 95 percent CI (.e., Trend_Q0.975 - Trend_Q0.025) Width_of_X_percent_Credible_Interval_Slope Width (percent/year) credible interval Trend calculation slope-based trend. Calculated widest credible interval requested quantiles argument. Default 95 percent CI (.e., Slope_Trend_Q0.975 - Slope_Trend_Q0.025) Number_of_Routes number unique BBS routes included annual indices region species, .e., number routes region species years since generate_indices(startyear) Mean_Number_of_Routes average number BBS routes across years contributing data region species backcast_flag approximate proportion included species range*years supported data given region year, e.g., 1.0 = data cover full time-series, 0.75 = data cover 75 percent time-series. calculated max_backcast != NULL","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_trends.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Generate regional trends — generate_trends","text":"posterior probabilities can calculated percent-decrease (prob_decrease) /percent-increase (prob_increase) desired. calculate probability populationhas decreased/increased least amount specified. example, prob_increase = 100 result calculation probability population increased 100% (.e., doubled) period trend. Alternatively, prob_decrease = 50 result calculation probability population decreased 50% (.e., less half population remains) period trend.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/generate_trends.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate regional trends — generate_trends","text":"","code":"# Toy example with Pacific Wren sample data # First, stratify the sample data s <- stratify(by = \"bbs_cws\", sample_data = TRUE) #> Using 'bbs_cws' (standard) stratification #> Using sample BBS data... #> Using species Pacific Wren (sample data) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Renaming routes...  # Prepare the stratified data for use in a JAGS model. d <- prepare_data(s, min_year = 2009, max_year = 2018)  # Now run the model (fast but not good, just for illustration) m <- run_model(d, model = \"first_diff\",                iter_sampling = 5, iter_warmup = 5, chains = 2) #> Running MCMC with 2 chains, at most 4 in parallel... #>  #> Chain 1 WARNING: No variance estimation is  #> Chain 1          performed for num_warmup < 20  #> Chain 1 Iteration: 1 / 10 [ 10%]  (Warmup)  #> Chain 1 Iteration: 6 / 10 [ 60%]  (Sampling)  #> Chain 1 Iteration: 10 / 10 [100%]  (Sampling)  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Log location parameter[1] is inf, but must be finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 2 WARNING: No variance estimation is  #> Chain 2          performed for num_warmup < 20  #> Chain 2 Iteration: 1 / 10 [ 10%]  (Warmup)  #> Chain 2 Iteration: 6 / 10 [ 60%]  (Sampling)  #> Chain 2 Iteration: 10 / 10 [100%]  (Sampling)  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 1 finished in 0.0 seconds. #> Chain 2 finished in 0.0 seconds. #>  #> Both chains finished successfully. #> Mean chain execution time: 0.0 seconds. #> Total execution time: 0.2 seconds. #>  #> Warning: 10 of 10 (100.0%) transitions ended with a divergence. #> See https://mc-stan.org/misc/warnings for details. #> Saving model output to /home/runner/work/bbsBayes/bbsBayes/docs/reference/BBS_STAN_first_diff_hier_2022-11-10_01.rds  # Generate the continental and stratum indices i <- generate_indices(model_output = m) #> Processing region stratum #> Processing region continent  # Now, generate the trends t <- generate_trends(i)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/have_bbs_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Check whether BBS data exists — have_bbs_data","title":"Check whether BBS data exists — have_bbs_data","text":"Check whether BBS data exists","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/have_bbs_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Check whether BBS data exists — have_bbs_data","text":"","code":"have_bbs_data(level = \"state\", release = 2022)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/have_bbs_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Check whether BBS data exists — have_bbs_data","text":"level Character. type BBS counts fetch, \"state\" \"stop\". Defaults \"state\". release Numeric. Yearly release. Options 2022 (default including data 2021 field season) 2020 (including data 2019)","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/have_bbs_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Check whether BBS data exists — have_bbs_data","text":"TRUE data found, FALSE otherwise","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/load_bbs_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Load Breeding Bird Survey dataset into R Session (TIDY) — load_bbs_data","title":"Load Breeding Bird Survey dataset into R Session (TIDY) — load_bbs_data","text":"Loads raw, unstratified BBS data current R session. data must previously fetched using fetch_bbs_data(). Note necessary run Bayesian analysis BBS data; calling stratify() loading .","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/load_bbs_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load Breeding Bird Survey dataset into R Session (TIDY) — load_bbs_data","text":"","code":"load_bbs_data(level = \"state\", release = 2022, sample = FALSE, quiet = TRUE)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/load_bbs_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load Breeding Bird Survey dataset into R Session (TIDY) — load_bbs_data","text":"level Character. type BBS counts fetch, \"state\" \"stop\". Defaults \"state\". release Numeric. Yearly release. Options 2022 (default including data 2021 field season) 2020 (including data 2019) quiet Logical. Suppress progress messages? Default FALSE","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/load_bbs_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load Breeding Bird Survey dataset into R Session (TIDY) — load_bbs_data","text":"Large list (3 elements) consisting : birds Data frame sample bird point count data per route, per year routes Data frame sample yearly route data species Sample list North American bird species","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/load_map.html","id":null,"dir":"Reference","previous_headings":"","what":"Load a map of of the geographic strata. — load_map","title":"Load a map of of the geographic strata. — load_map","text":"load_map allows load simple features object (sf package) represents map strata can easily plotted.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/load_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Load a map of of the geographic strata. — load_map","text":"","code":"load_map(stratify_by = NULL, type = \"strata\")"},{"path":"http://steffilazerte.ca/bbsBayes/reference/load_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Load a map of of the geographic strata. — load_map","text":"stratify_by Character. Stratification type. One \"prov_state\", \"bcr\", \"latlong\", \"bbs_cws\", \"bbs_usgs\". type Character. \"strata\" political map (\"North America\", \"Canada\" \"US\"/\"USA\"/\"United States America\").","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/load_map.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Load a map of of the geographic strata. — load_map","text":"sf polygon object","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/load_map.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Load a map of of the geographic strata. — load_map","text":"","code":"# Toy example with Pacific Wren sample data # First, stratify the sample data strat_map <- load_map(stratify_by = \"bbs_cws\")  # simple plot of the map plot(strat_map)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/pacific_wren_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Example model output — pacific_wren_model","title":"Example model output — pacific_wren_model","text":"Pacific wren model output","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/pacific_wren_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Example model output — pacific_wren_model","text":"","code":"pacific_wren_model"},{"path":"http://steffilazerte.ca/bbsBayes/reference/pacific_wren_model.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Example model output — pacific_wren_model","text":"object class list length 5.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"http://steffilazerte.ca/bbsBayes/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_geofacet.html","id":null,"dir":"Reference","previous_headings":"","what":"Create geofacet plot of population trajectories by province/state — plot_geofacet","title":"Create geofacet plot of population trajectories by province/state — plot_geofacet","text":"Generate faceted plot population trajectories strata province/state. Given model stratified \"state\", \"bbs_cws\", \"bbs_usgs\" indices generated generate_indices() function generate faceted plot showing population trajectories. geofacet plots one facet per state/province, strata-level indices \"bbs_cws\" \"bbs_usgs\" given, function plots multiple trajectories (one relevant strata) within facet.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_geofacet.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Create geofacet plot of population trajectories by province/state — plot_geofacet","text":"","code":"plot_geofacet(   indices,   ci_width = 0.95,   multiple = FALSE,   trends = NULL,   slope = FALSE,   add_observed_means = FALSE,   col_viridis = FALSE,   indices_list,   stratify_by,   species,   select )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_geofacet.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Create geofacet plot of population trajectories by province/state — plot_geofacet","text":"indices List. Indices generated generate_indices() ci_width quantile define width plotted credible interval. Defaults 0.95, lower = 0.025 upper = 0.975 multiple Logical, TRUE, multiple strata-level trajectories plotted within prov/state facet trends Optional dataframe matching strata state/province trends produced generate_trends(). included trajectories coloured based colour scale used plot_map slope Logical. dataframe trends included, whether colours plot based slope trends. Default = FALSE add_observed_means facet plots include points indicating observed mean counts. Defaults FALSE.  Note: scale observed means annual indices may match due imbalanced sampling among strata col_viridis Logical flag use \"viridis\" colour-blind friendly palette. Default FALSE indices_list Deprecated. Use indices instead stratify_by Defunct. species Defunct. select Defunct.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_geofacet.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Create geofacet plot of population trajectories by province/state — plot_geofacet","text":"ggplot object","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_geofacet.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Create geofacet plot of population trajectories by province/state — plot_geofacet","text":"","code":"# Toy example with Pacific Wren sample data # First, stratify the sample data s <- stratify(by = \"bbs_cws\", sample_data = TRUE) #> Using 'bbs_cws' (standard) stratification #> Using sample BBS data... #> Using species Pacific Wren (sample data) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Renaming routes...  # Prepare the stratified data for modelling d <- prepare_data(s,                   min_year = 2009,                   max_year = 2018)  # Now run the model (fast but not good, just for illustration) m <- run_model(d, model = \"first_diff\",                iter_sampling = 10, iter_warmup = 10, chains = 2) #> Running MCMC with 2 chains, at most 4 in parallel... #>  #> Chain 1 WARNING: No variance estimation is  #> Chain 1          performed for num_warmup < 20  #> Chain 1 Iteration:  1 / 20 [  5%]  (Warmup)  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Log location parameter[1] is inf, but must be finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 2 WARNING: No variance estimation is  #> Chain 2          performed for num_warmup < 20  #> Chain 2 Iteration:  1 / 20 [  5%]  (Warmup)  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 1 Iteration: 11 / 20 [ 55%]  (Sampling)  #> Chain 1 Iteration: 20 / 20 [100%]  (Sampling)  #> Chain 1 finished in 6.9 seconds. #> Chain 2 Iteration: 11 / 20 [ 55%]  (Sampling)  #> Chain 2 Iteration: 20 / 20 [100%]  (Sampling)  #> Chain 2 finished in 25.6 seconds. #>  #> Both chains finished successfully. #> Mean chain execution time: 16.3 seconds. #> Total execution time: 25.7 seconds. #>  #> Saving model output to /home/runner/work/bbsBayes/bbsBayes/docs/reference/BBS_STAN_first_diff_hier_2022-11-10_01.rds  # Generate indices i <- generate_indices(m, regions = c(\"stratum\", \"prov_state\")) #> Processing region stratum #> Processing region prov_state t <- generate_trends(i)  # Now make the geofacet plot. plot_geofacet(i, trends = t, multiple = TRUE)  plot_geofacet(i, trends = t, multiple = TRUE, col_viridis = TRUE)  plot_geofacet(i, multiple = TRUE)  plot_geofacet(i, trends = t, multiple = FALSE)  plot_geofacet(i, multiple = FALSE)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_indices.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate plots of index trajectories by stratum — plot_indices","title":"Generate plots of index trajectories by stratum — plot_indices","text":"Generates indices plot stratum modelled.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_indices.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate plots of index trajectories by stratum — plot_indices","text":"","code":"plot_indices(   indices = NULL,   ci_width = 0.95,   min_year = NULL,   max_year = NULL,   title = TRUE,   title_size = 20,   axis_title_size = 18,   axis_text_size = 16,   line_width = 1,   add_observed_means = FALSE,   add_number_routes = FALSE,   indices_list,   species )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_indices.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate plots of index trajectories by stratum — plot_indices","text":"indices List. Indices generated generate_indices() ci_width Numeric. Quantile defining width plotted credible interval. Defaults 0.95 (lower = 0.025 upper = 0.975) min_year Numeric. Minimum year plot max_year Numeric. Maximum year plot title Logical. Whether include title plot. title_size Numeric. Font size plot title. Defaults 20 axis_title_size Numeric. Font size axis titles. Defaults 18 axis_text_size Numeric. Font size axis text. Defaults 16 line_width Numeric. Size trajectory line. Defaults 1 add_observed_means Logical. Whether include points indicating observed mean counts. Default FALSE. Note: scale observed means annual indices may match due imbalanced sampling among routes add_number_routes Logical. Whether superimpose plot dotplot showing number BBS routes included year. useful visual check relative data-density time cases number observations increases time indices_list Deprecated. Use indices instead species Defunct. Use title instead","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_indices.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate plots of index trajectories by stratum — plot_indices","text":"List ggplot objects, entry plot stratum indices","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_indices.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate plots of index trajectories by stratum — plot_indices","text":"","code":"# Toy example with Pacific Wren sample data # First, stratify the sample data s <- stratify(by = \"bbs_cws\", sample_data = TRUE) #> Using 'bbs_cws' (standard) stratification #> Using sample BBS data... #> Using species Pacific Wren (sample data) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Renaming routes...  # Prepare the stratified data for modelling d <- prepare_data(s,                   min_year = 2009,                   max_year = 2018)  # Now run the model (fast but not good, just for illustration) m <- run_model(d, model = \"first_diff\",                iter_sampling = 5, iter_warmup = 5, chains = 2) #> Running MCMC with 2 chains, at most 4 in parallel... #>  #> Chain 1 WARNING: No variance estimation is  #> Chain 1          performed for num_warmup < 20  #> Chain 1 Iteration: 1 / 10 [ 10%]  (Warmup)  #> Chain 1 Iteration: 6 / 10 [ 60%]  (Sampling)  #> Chain 1 Iteration: 10 / 10 [100%]  (Sampling)  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Log location parameter[1] is -nan, but must be finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 2 WARNING: No variance estimation is  #> Chain 2          performed for num_warmup < 20  #> Chain 2 Iteration: 1 / 10 [ 10%]  (Warmup)  #> Chain 2 Iteration: 6 / 10 [ 60%]  (Sampling)  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 1 finished in 0.0 seconds. #> Chain 2 Iteration: 10 / 10 [100%]  (Sampling)  #> Chain 2 finished in 0.7 seconds. #>  #> Both chains finished successfully. #> Mean chain execution time: 0.4 seconds. #> Total execution time: 0.8 seconds. #>  #> Warning: 5 of 10 (50.0%) transitions ended with a divergence. #> See https://mc-stan.org/misc/warnings for details. #> Saving model output to /home/runner/work/bbsBayes/bbsBayes/docs/reference/BBS_STAN_first_diff_hier_2022-11-10_01.rds  # Generate country, continent, and stratum indices i <- generate_indices(model_output = m,                       regions = c(\"country\", \"continent\", \"stratum\")) #> Processing region country #> Processing region continent #> Processing region stratum  # Now, plot_indices() will generate a list of plots for all regions plots <- plot_indices(i)  # To view any plot, use [[i]] plots[[1]]   names(plots) #>  [1] \"Canada\"                   \"United_States_of_America\" #>  [3] \"continent\"                \"CA_BC_10\"                 #>  [5] \"CA_BC_5\"                  \"CA_BC_9\"                  #>  [7] \"US_AK_5\"                  \"US_CA_15\"                 #>  [9] \"US_CA_32\"                 \"US_CA_5\"                  #> [11] \"US_ID_10\"                 \"US_MT_10\"                 #> [13] \"US_OR_10\"                 \"US_OR_5\"                  #> [15] \"US_OR_9\"                  \"US_WA_10\"                 #> [17] \"US_WA_5\"                  \"US_WA_9\"                   # Suppose we wanted to access the continental plot. We could do so with cont_plot <- plots[[\"continental\"]]  # You can specify to only plot a subset of years using min_year and max_year  # Plots indices from 2015 onward p_2015_min <- plot_indices(i, min_year = 2015)  #Plot up indices up to the year 2017 p_2017_max <- plot_indices(i, max_year = 2017)  #Plot indices between 2011 and 2016 p_2011_2016 <- plot_indices(i, min_year = 2011, max_year = 2016)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_map.html","id":null,"dir":"Reference","previous_headings":"","what":"Generate a map of trends by strata — plot_map","title":"Generate a map of trends by strata — plot_map","text":"plot_map() allows generate colour-coded map percent change species trends strata.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_map.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Generate a map of trends by strata — plot_map","text":"","code":"plot_map(   trends,   slope = FALSE,   title = TRUE,   col_viridis = TRUE,   species,   stratify_by,   select )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_map.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Generate a map of trends by strata — plot_map","text":"trends Data frame. Trends produced generate_trends(). slope Logical. Whether map values alternative trend metric (slope log-linear regression) slope = TRUE used generate_trends(),  annual indices. Default FALSE. title Logical. Whether include title species. Default TRUE. col_viridis Logical flag use \"viridis\" colour-blind friendly palette. Default FALSE species Defunct. Use title instead stratify_by Defunct. select Defunct.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_map.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Generate a map of trends by strata — plot_map","text":"spplot object","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/plot_map.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Generate a map of trends by strata — plot_map","text":"","code":"# Toy example with Pacific Wren sample data # First, stratify the sample data s <- stratify(by = \"bbs_cws\", sample_data = TRUE) #> Using 'bbs_cws' (standard) stratification #> Using sample BBS data... #> Using species Pacific Wren (sample data) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Renaming routes...  # Prepare the stratified data for use in a JAGS model. d <- prepare_data(s, min_year = 2009, max_year = 2018)  # Now run the model (fast but not good, just for illustration) m <- run_model(d, model = \"first_diff\",                iter_sampling = 5, iter_warmup = 5, chains = 2) #> Running MCMC with 2 chains, at most 4 in parallel... #>  #> Chain 1 WARNING: No variance estimation is  #> Chain 1          performed for num_warmup < 20  #> Chain 1 Iteration: 1 / 10 [ 10%]  (Warmup)  #> Chain 1 Iteration: 6 / 10 [ 60%]  (Sampling)  #> Chain 1 Iteration: 10 / 10 [100%]  (Sampling)  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 1 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 1 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 1 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 1 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 1  #> Chain 2 WARNING: No variance estimation is  #> Chain 2          performed for num_warmup < 20  #> Chain 2 Iteration: 1 / 10 [ 10%]  (Warmup)  #> Chain 2 Iteration: 6 / 10 [ 60%]  (Sampling)  #> Chain 2 Iteration: 10 / 10 [100%]  (Sampling)  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 2 Informational Message: The current Metropolis proposal is about to be rejected because of the following issue: #> Chain 2 Exception: neg_binomial_2_log_lpmf: Precision parameter is 0, but must be positive finite! (in '/tmp/RtmpuMaWIr/model-44764154007f.stan', line 227, column 3 to column 40) #> Chain 2 If this warning occurs sporadically, such as for highly constrained variable types like covariance matrices, then the sampler is fine, #> Chain 2 but if this warning occurs often then your model may be either severely ill-conditioned or misspecified. #> Chain 2  #> Chain 1 finished in 0.0 seconds. #> Chain 2 finished in 0.0 seconds. #>  #> Both chains finished successfully. #> Mean chain execution time: 0.0 seconds. #> Total execution time: 0.2 seconds. #>  #> Warning: 10 of 10 (100.0%) transitions ended with a divergence. #> See https://mc-stan.org/misc/warnings for details. #> Saving model output to /home/runner/work/bbsBayes/bbsBayes/docs/reference/BBS_STAN_first_diff_hier_2022-11-10_01.rds  # Generate the continental and stratum indices i <- generate_indices(m) #> Processing region stratum #> Processing region continent  # Now, generate the trends t <- generate_trends(i)  # Generate the map map <- plot_map(t) #> Error in stop(\"`\", type, \"` must a list created by `\", from, \"` \", \"containing\\n`\",     paste0(n, collapse = \"`, `\"), \"`\", call. = FALSE): object 'from' not found"},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrangle data to use for modelling input (STAN TIDY) — prepare_data","title":"Wrangle data to use for modelling input (STAN TIDY) — prepare_data","text":"Subset raw BBS data selected species wrangle stratified data use input models.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrangle data to use for modelling input (STAN TIDY) — prepare_data","text":"","code":"prepare_data(   strata_data,   min_year = NULL,   max_year = NULL,   min_n_routes = 3,   min_max_route_years = 3,   min_mean_route_years = 1,   quiet = FALSE,   species,   model,   heavy_tailed,   n_knots,   basis,   sampler,   strat_data,   strata_rem )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Wrangle data to use for modelling input (STAN TIDY) — prepare_data","text":"strata_data List. Stratified data returned stratify() min_year Numeric. Minimum year use. Default (NULL) uses first year data. max_year Numeric. Maximum year use. Default (NULL) uses first year data. min_n_routes Numeric. Required minimum routes per strata species observed. Defaults 3 min_max_route_years Required minimum number years non-zero observations species least 1 route. Defaults 3 min_mean_route_years Required minimum average years per route species observed. Defaults 1. quiet Logical. Suppress progress messages? Default FALSE species Defunct. Use species stratify() instead model Defunct. Use model run_model() instead heavy_tailed Defunct. Use heavy_tailed run_model() instead n_knots Defunct. Use n_knots run_model() instead basis Defunct. Use basis run_model() instead sampler Defunct. strat_data Defunct. Use strata_data instead strata_rem Defunct. Use custom_strata stratify() instead","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Wrangle data to use for modelling input (STAN TIDY) — prepare_data","text":"List prepared (meta) data used modelling steps. model_data list data formatted use Stan modelling meta_data contains species, stratify_by, stratify_type meta_strata contains data frame listing strata names area strata relevant data (.e. may removed due lack count data). Specifically, strata_name (label stratum), strata (numeric code) area_sq_km raw_data contains data frame summarized data used create model_data (just formatted nicely)","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Wrangle data to use for modelling input (STAN TIDY) — prepare_data","text":"","code":"# Toy example with Pacific Wren sample data  # First, stratify the sample data  strat_data <- stratify(by = \"bbs_cws\", sample_data = TRUE) #> Using 'bbs_cws' (standard) stratification #> Using sample BBS data... #> Using species Pacific Wren (sample data) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Renaming routes...  # Prepare the stratified data for use in a model. In this #   toy example, we will set the minimum year as 2009 and #   maximum year as 2018, effectively only setting up to #   model 10 years of data.  model_data <- prepare_data(strat_data, min_year = 2009, max_year = 2018)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_spatial.html","id":null,"dir":"Reference","previous_headings":"","what":"Define neighbouring strata for spatial analyses — prepare_spatial","title":"Define neighbouring strata for spatial analyses — prepare_spatial","text":"Given spatial data frame containing polygons points outline strata, neighbourhood matrix identified use run_model()","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_spatial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define neighbouring strata for spatial analyses — prepare_spatial","text":"","code":"prepare_spatial(   strata_map,   prepped_data,   voronoi = FALSE,   nearest_fill = FALSE,   island_link_dist_factor = 1.2,   buffer_type = \"buffer\",   buffer_dist = 10000,   add_map = NULL,   quiet = FALSE )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_spatial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define neighbouring strata for spatial analyses — prepare_spatial","text":"strata_map sf data frame. Map strata (MULTI)POLYGONs. Must column \"strata_name\" matching strata output prepare_data(). prepped_data List. Output prepare_data(). Use @inheritParams common_docs include function documentation matching argument (include matching args) voronoi Logical. Whether use Voroni method polygons. (Must use Voronoi method points). nearest_fill Logical. strata neighbours, whether fill centroids 2 nearest neighbours using Voronoi method. island_link_dist_factor Numeric. Distances within factor amount considered nearest strata neighbours. Used linking otherwise isolated islands strata, using Voronoi method. buffer_type Character. buffer type use using Voronoi method. Must one buffer convex_hull. See Details specifics. buffer_dist Numeric. Distance buffer link strata connected using Voronoi method. Units sf::st_crs(strata_map). starting distance buffer_type = \"buffer\" final distance buffer_type = \"convex_hull\". See Details. add_map sf spatial object. Spatial data add map output. quiet Logical. Suppress progress messages? Default FALSE","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_spatial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define neighbouring strata for spatial analyses — prepare_spatial","text":"List containing samples, nodes, adjacent matrix map visualizing matrix","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_spatial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Define neighbouring strata for spatial analyses — prepare_spatial","text":"using Voronoi method, buffer used fill around link strata together. buffer_type buffer, buffer_dist starting distance buffer. strata linked, distance increased 10% applied , repeating strata linked. buffer_type convex_hull, convex hull used link strata appling buffer distance buffer_dist. Note distances units sf::st_crs(strata_map).","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/prepare_spatial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Define neighbouring strata for spatial analyses — prepare_spatial","text":"","code":"bbs_data <- stratify(by = \"bbs_cws\", species = \"Connecticut Warbler\") #> Using 'bbs_cws' (standard) stratification #> Loading BBS data... #> Filtering to species Connecticut Warbler (6780) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Renaming routes...  model_data <- prepare_data(bbs_data, min_max_route_years = 2)  map <- load_map(\"bbs_cws\")  sp <- prepare_spatial(map, model_data) #> Preparing spatial data... #> Identifying neighbours (non-Voronoi method)... #> Formating neighbourhood matrices... #> Plotting neighbourhood matrices..."},{"path":"http://steffilazerte.ca/bbsBayes/reference/remove_cache.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove bbsBayes cache — remove_cache","title":"Remove bbsBayes cache — remove_cache","text":"Remove data downloaded via fetch_bbs_data() well model executables created cmdstanr::cmdstan_model() via run_model().","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/remove_cache.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove bbsBayes cache — remove_cache","text":"","code":"remove_cache(type = \"bbs_data\", level, release)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/remove_cache.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove bbsBayes cache — remove_cache","text":"level Character. Data remove, one \"\", \"state\", \"stop\" release Character/Numeric. Data remove, one \"\", 2020, 2022 cache_dir Logical. Remove entire cache directory (data contained therein)","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/remove_cache.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove bbsBayes cache — remove_cache","text":"Nothing.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/remove_cache.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove bbsBayes cache — remove_cache","text":"","code":"if (FALSE) { # Remove everything remove_cache(type = \"all\")  # Remove all BBS data files (but not the dir) remove_cache(level = \"all\", release = \"all\")  # Remove all 'stop' data remove_cache(level = \"stop\", release = \"all\")  # Remove all 2020 data remoremove_cacheve_bbs_data(level = \"all\", release = 2020)  # Remove 2020 stop data remove_cache(level = \"stop\", release = 2020)  # Remove all model executables remove_cache(type = \"model\") }"},{"path":"http://steffilazerte.ca/bbsBayes/reference/route_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample route data per year run (Pacific Wren only) — route_sample","title":"Sample route data per year run (Pacific Wren only) — route_sample","text":"dataset containing data route run per year. NOTE: contains data Pacific Wren, full data set. full count set obtained via function fetch_bbs_data. data obtained United States Geological Survey subject change new data added year. See Details citation.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/route_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample route data per year run (Pacific Wren only) — route_sample","text":"","code":"route_sample"},{"path":"http://steffilazerte.ca/bbsBayes/reference/route_sample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sample route data per year run (Pacific Wren only) — route_sample","text":"object class data.frame 4875 rows 32 columns.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/route_sample.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sample route data per year run (Pacific Wren only) — route_sample","text":"Pardieck, K.L., D.J. Ziolkowski Jr., M. Lutmerding, V. Aponte M-.R. Hudson. 2019. North American Breeding Bird Survey Dataset 1966 - 2018, version 2018.0. U.S. Geological Survey, Patuxent Wildlife Research Center. https://doi.org/10.5066/P9HE8XYJ.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/run_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Run Bayesian model — run_model","title":"Run Bayesian model — run_model","text":"Run Bayesian model","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/run_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run Bayesian model — run_model","text":"","code":"run_model(   prepped_data,   model,   model_variant = \"hier\",   spatial_data = NULL,   heavy_tailed = TRUE,   n_knots = NULL,   basis = \"mgcv\",   use_pois = FALSE,   calculate_nu = FALSE,   calculate_log_lik = FALSE,   calculate_CV = FALSE,   refresh = 100,   chains = 4,   parallel_chains = 4,   iter_warmup = 1000,   iter_sampling = 1000,   adapt_delta = 0.95,   max_treedepth = 14,   init_def = NULL,   out_name = NULL,   out_dir = \".\",   save_output = TRUE,   quiet = FALSE,   jags_data,   inits,   parameters_to_save,   track_n,   n_adapt,   n_burnin,   n_thin,   n_chains,   n_saved_steps,   n_iter,   modules,   parallel,   n_cores,   ... )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/run_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run Bayesian model — run_model","text":"prepped_data List. Output prepare_data(). Use @inheritParams common_docs include function documentation matching argument (include matching args) model Character. Type model run, must one \"first_diff\" (First Differences), \"gam\" (General Additive Model), \"gamye\" (General Additive Model Year Effect), \"slope\" (Slope model). model_variant Character. Model variant run, must one \"nonhier\" (Non-hierarchical), \"hier\" (Hierarchical), \"spatial\" (Spatially explicit). spatial_data List. Output prepare_spatial(). heavy_tailed Logical. Whether extra-Poisson error distributions modelled t-distribution, heavier tails standard normal distribution. Default TRUE. Recent results suggest best even though requires much longer convergence times. n_knots Numeric. Number knots \"gam\" \"gamye\" models basis Character. Basis function use GAM smooth, one \"original\" \"mgcv\". Default \"original\", basis used Smith Edwards 2020. \"mgcv\" alternate uses \"tp\" basis package mgcv (also used brms, rstanarm). using \"mgcv\" option, user may want consider adjusting prior distributions parameters precision. use_pois Logical. calculate_nu Logical. calculate_log_lik Logical. calculate_CV Logical. refresh Numeric. Passed cmdstanr::sample. Number iterations screen updates. 0, errors shown. chains Numeric. Passed cmdstanr::sample. Number Markov chains run. parallel_chains Numeric. Passed cmdstanr::sample. Maximum number chains run parallel. iter_warmup Numeric. Passed cmdstanr::sample. Number warmup iterations per chain. iter_sampling Numeric. Passed cmdstanr::sample. Number sampling (post-warmup) iterations per chain. adapt_delta Numeric. max_treedepth Numeric. init_def List. out_name Character. out_dir Character. quiet Logical jags_data Defunct. inits Defunct. parameters_to_save Defunct. track_n Defunct. n_adapt Defunct. n_burnin Defunct. n_thin Defunct. n_chains Defunct. n_saved_steps Defunct. n_iter Defunct. modules Defunct. parallel Defunct. n_cores Defunct. ... arguments passed cmdstanr::sample","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/run_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run Bayesian model — run_model","text":"","code":"# You can also specify the GAM model, with an optional number of # knots to use for the GAM basis. # By default, the number of knots will be equal to the floor # of the total unique years for the species / 4 #model_data <- prepare_data(strat_data, #                           model = \"gam\", #                           n_knots = 9)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/save_model_run.html","id":null,"dir":"Reference","previous_headings":"","what":"Save output of run_model() — save_model_run","title":"Save output of run_model() — save_model_run","text":"function closely imitate cmdstanr::save_object() saves entire model output oject run_model() contains details regarding stratification etc.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/save_model_run.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Save output of run_model() — save_model_run","text":"","code":"save_model_run(model_output, path = NULL, quiet = FALSE)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/save_model_run.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Save output of run_model() — save_model_run","text":"model_output List. Output run_model(). path Character. Optional file path use saved data. Defaults file path used original run quiet Logical. Suppress progress messages? Default FALSE","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/search_species.html","id":null,"dir":"Reference","previous_headings":"","what":"Search for species — search_species","title":"Search for species — search_species","text":"helper function finding appropriate species name use stratify().","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/search_species.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Search for species — search_species","text":"","code":"search_species(species, combine_species_forms = TRUE)"},{"path":"http://steffilazerte.ca/bbsBayes/reference/search_species.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Search for species — search_species","text":"species Character. Search term, either name English French, AOU code, scientific genus species. combine_species_forms Logical. Whether search combined species data uncombined species. Note results different species names.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/search_species.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Search for species — search_species","text":"Data frame subset BBS species data frame","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/search_species.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Search for species — search_species","text":"","code":"# Search for various terms search_species(\"Paridae\") #> # A tibble: 17 × 9 #>      aou english               french spanish order family genus species unid_…¹ #>    <dbl> <chr>                 <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #>  1  7360 Carolina Chickadee    Mésan… Poecil… Pass… Parid… Poec… caroli… TRUE    #>  2  7350 Black-capped Chickad… Mésan… Poecil… Pass… Parid… Poec… atrica… TRUE    #>  3  7380 Mountain Chickadee    Mésan… Poecil… Pass… Parid… Poec… gambeli TRUE    #>  4  7370 Mexican Chickadee     Mésan… Poecil… Pass… Parid… Poec… sclate… TRUE    #>  5  7410 Chestnut-backed Chic… Mésan… Poecil… Pass… Parid… Poec… rufesc… TRUE    #>  6  7400 Boreal Chickadee      Mésan… Poecil… Pass… Parid… Poec… hudson… TRUE    #>  7  7352 unid. Carolina Chick… unid … Poecil… Pass… Parid… Poec… caroli… TRUE    #>  8  7353 unid. Black-capped C… unid … Poecil… Pass… Parid… Poec… atrica… TRUE    #>  9  7354 unid. Black-capped C… unid … Poecil… Pass… Parid… Poec… atrica… TRUE    #> 10  7351 unid. western chicka… unid … Poecil… Pass… Parid… Poec… sp.     TRUE    #> 11  7340 Bridled Titmouse      Mésan… Baeolo… Pass… Parid… Baeo… wollwe… TRUE    #> 12  7330 Oak Titmouse          Mésan… Baeolo… Pass… Parid… Baeo… inorna… TRUE    #> 13  7331 Juniper Titmouse      Mésan… Baeolo… Pass… Parid… Baeo… ridgwa… TRUE    #> 14  7332 unid. Oak Titmouse /… unid … Baeolo… Pass… Parid… Baeo… inorna… TRUE    #> 15  7310 Tufted Titmouse       Mésan… Baeolo… Pass… Parid… Baeo… bicolor TRUE    #> 16  7320 Black-crested Titmou… Mésan… Baeolo… Pass… Parid… Baeo… atricr… TRUE    #> 17  7315 unid. Tufted Titmous… unid … Baeolo… Pass… Parid… Baeo… bicolo… TRUE    #> # … with abbreviated variable name ¹​unid_combined search_species(\"chickadee\") #> # A tibble: 10 × 9 #>      aou english               french spanish order family genus species unid_…¹ #>    <dbl> <chr>                 <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #>  1  7360 Carolina Chickadee    Mésan… Poecil… Pass… Parid… Poec… caroli… TRUE    #>  2  7350 Black-capped Chickad… Mésan… Poecil… Pass… Parid… Poec… atrica… TRUE    #>  3  7380 Mountain Chickadee    Mésan… Poecil… Pass… Parid… Poec… gambeli TRUE    #>  4  7370 Mexican Chickadee     Mésan… Poecil… Pass… Parid… Poec… sclate… TRUE    #>  5  7410 Chestnut-backed Chic… Mésan… Poecil… Pass… Parid… Poec… rufesc… TRUE    #>  6  7400 Boreal Chickadee      Mésan… Poecil… Pass… Parid… Poec… hudson… TRUE    #>  7  7352 unid. Carolina Chick… unid … Poecil… Pass… Parid… Poec… caroli… TRUE    #>  8  7353 unid. Black-capped C… unid … Poecil… Pass… Parid… Poec… atrica… TRUE    #>  9  7354 unid. Black-capped C… unid … Poecil… Pass… Parid… Poec… atrica… TRUE    #> 10  7351 unid. western chicka… unid … Poecil… Pass… Parid… Poec… sp.     TRUE    #> # … with abbreviated variable name ¹​unid_combined search_species(\"mésang\") #> # A tibble: 19 × 9 #>      aou english               french spanish order family genus species unid_…¹ #>    <dbl> <chr>                 <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #>  1  4840 Canada Jay            Mésan… Periso… Pass… Corvi… Peri… canade… TRUE    #>  2  7360 Carolina Chickadee    Mésan… Poecil… Pass… Parid… Poec… caroli… TRUE    #>  3  7350 Black-capped Chickad… Mésan… Poecil… Pass… Parid… Poec… atrica… TRUE    #>  4  7380 Mountain Chickadee    Mésan… Poecil… Pass… Parid… Poec… gambeli TRUE    #>  5  7370 Mexican Chickadee     Mésan… Poecil… Pass… Parid… Poec… sclate… TRUE    #>  6  7410 Chestnut-backed Chic… Mésan… Poecil… Pass… Parid… Poec… rufesc… TRUE    #>  7  7400 Boreal Chickadee      Mésan… Poecil… Pass… Parid… Poec… hudson… TRUE    #>  8  7352 unid. Carolina Chick… unid … Poecil… Pass… Parid… Poec… caroli… TRUE    #>  9  7353 unid. Black-capped C… unid … Poecil… Pass… Parid… Poec… atrica… TRUE    #> 10  7354 unid. Black-capped C… unid … Poecil… Pass… Parid… Poec… atrica… TRUE    #> 11  7351 unid. western chicka… unid … Poecil… Pass… Parid… Poec… sp.     TRUE    #> 12  7340 Bridled Titmouse      Mésan… Baeolo… Pass… Parid… Baeo… wollwe… TRUE    #> 13  7330 Oak Titmouse          Mésan… Baeolo… Pass… Parid… Baeo… inorna… TRUE    #> 14  7331 Juniper Titmouse      Mésan… Baeolo… Pass… Parid… Baeo… ridgwa… TRUE    #> 15  7332 unid. Oak Titmouse /… unid … Baeolo… Pass… Parid… Baeo… inorna… TRUE    #> 16  7310 Tufted Titmouse       Mésan… Baeolo… Pass… Parid… Baeo… bicolor TRUE    #> 17  7320 Black-crested Titmou… Mésan… Baeolo… Pass… Parid… Baeo… atricr… TRUE    #> 18  7315 unid. Tufted Titmous… unid … Baeolo… Pass… Parid… Baeo… bicolo… TRUE    #> 19  7430 Bushtit               Mésan… Psaltr… Pass… Aegit… Psal… minimus TRUE    #> # … with abbreviated variable name ¹​unid_combined search_species(\"Poecile\") #> # A tibble: 10 × 9 #>      aou english               french spanish order family genus species unid_…¹ #>    <dbl> <chr>                 <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #>  1  7360 Carolina Chickadee    Mésan… Poecil… Pass… Parid… Poec… caroli… TRUE    #>  2  7350 Black-capped Chickad… Mésan… Poecil… Pass… Parid… Poec… atrica… TRUE    #>  3  7380 Mountain Chickadee    Mésan… Poecil… Pass… Parid… Poec… gambeli TRUE    #>  4  7370 Mexican Chickadee     Mésan… Poecil… Pass… Parid… Poec… sclate… TRUE    #>  5  7410 Chestnut-backed Chic… Mésan… Poecil… Pass… Parid… Poec… rufesc… TRUE    #>  6  7400 Boreal Chickadee      Mésan… Poecil… Pass… Parid… Poec… hudson… TRUE    #>  7  7352 unid. Carolina Chick… unid … Poecil… Pass… Parid… Poec… caroli… TRUE    #>  8  7353 unid. Black-capped C… unid … Poecil… Pass… Parid… Poec… atrica… TRUE    #>  9  7354 unid. Black-capped C… unid … Poecil… Pass… Parid… Poec… atrica… TRUE    #> 10  7351 unid. western chicka… unid … Poecil… Pass… Parid… Poec… sp.     TRUE    #> # … with abbreviated variable name ¹​unid_combined search_species(\"blue grouse\") #> # A tibble: 1 × 9 #>     aou english                french spanish order family genus species unid_…¹ #>   <dbl> <chr>                  <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #> 1  2973 Blue Grouse (Dusky/So… Tétra… Dendra… Gall… Phasi… Dend… obscur… TRUE    #> # … with abbreviated variable name ¹​unid_combined search_species(\"sooty grouse\") #> # A tibble: 2 × 9 #>     aou english                french spanish order family genus species unid_…¹ #>   <dbl> <chr>                  <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #> 1  2971 Sooty Grouse           Tétra… Dendra… Gall… Phasi… Dend… fuligi… TRUE    #> 2  2973 Blue Grouse (Dusky/So… Tétra… Dendra… Gall… Phasi… Dend… obscur… TRUE    #> # … with abbreviated variable name ¹​unid_combined  # To combine or not search_species(\"blue grouse\", combine_species_forms = FALSE) #> # A tibble: 0 × 9 #> # … with 9 variables: aou <dbl>, english <chr>, french <chr>, spanish <chr>, #> #   order <chr>, family <chr>, genus <chr>, species <chr>, unid_combined <lgl> search_species(\"sooty grouse\", combine_species_forms = FALSE) #> # A tibble: 2 × 9 #>     aou english                french spanish order family genus species unid_…¹ #>   <dbl> <chr>                  <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #> 1  2971 Sooty Grouse           Tétra… Dendra… Gall… Phasi… Dend… fuligi… FALSE   #> 2  2973 unid. Dusky Grouse / … unid … Dendra… Gall… Phasi… Dend… obscur… FALSE   #> # … with abbreviated variable name ¹​unid_combined search_species(\"northern flicker\") #> # A tibble: 4 × 9 #>     aou english                french spanish order family genus species unid_…¹ #>   <dbl> <chr>                  <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #> 1  4123 Northern Flicker (all… Pic f… Colapt… Pici… Picid… Cola… auratus TRUE    #> 2  4120 (Yellow-shafted Flick… Pic f… Colapt… Pici… Picid… Cola… auratu… TRUE    #> 3  4130 (Red-shafted Flicker)… Pic f… Colapt… Pici… Picid… Cola… auratu… TRUE    #> 4  4125 hybrid Northern Flick… hybri… Colapt… Pici… Picid… Cola… auratu… TRUE    #> # … with abbreviated variable name ¹​unid_combined search_species(\"northern flicker\", combine_species_forms = FALSE) #> # A tibble: 4 × 9 #>     aou english                french spanish order family genus species unid_…¹ #>   <dbl> <chr>                  <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #> 1  4123 (unid. Red/Yellow Sha… Pic f… Colapt… Pici… Picid… Cola… auratus FALSE   #> 2  4120 (Yellow-shafted Flick… Pic f… Colapt… Pici… Picid… Cola… auratu… FALSE   #> 3  4130 (Red-shafted Flicker)… Pic f… Colapt… Pici… Picid… Cola… auratu… FALSE   #> 4  4125 hybrid Northern Flick… hybri… Colapt… Pici… Picid… Cola… auratu… FALSE   #> # … with abbreviated variable name ¹​unid_combined"},{"path":"http://steffilazerte.ca/bbsBayes/reference/species_forms.html","id":null,"dir":"Reference","previous_headings":"","what":"Species forms — species_forms","title":"Species forms — species_forms","text":"Data frame species forms combined combine_species_forms TRUE stratify().","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/species_forms.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Species forms — species_forms","text":"","code":"species_forms"},{"path":"http://steffilazerte.ca/bbsBayes/reference/species_forms.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Species forms — species_forms","text":"object class data.frame 13 rows 5 columns.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/species_sample.html","id":null,"dir":"Reference","previous_headings":"","what":"Sample North American bird species list (Pacific Wren only) — species_sample","title":"Sample North American bird species list (Pacific Wren only) — species_sample","text":"dataset containing species list North America. NOTE: contains data Pacific Wren, full data set. full count set obtained via function fetch_bbs_data. data obtained United States Geological Survey subject change new data added year. See Details citation.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/species_sample.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Sample North American bird species list (Pacific Wren only) — species_sample","text":"","code":"species_sample"},{"path":"http://steffilazerte.ca/bbsBayes/reference/species_sample.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Sample North American bird species list (Pacific Wren only) — species_sample","text":"object class tbl_df (inherits tbl, data.frame) 1 rows 10 columns.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/species_sample.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Sample North American bird species list (Pacific Wren only) — species_sample","text":"Pardieck, K.L., D.J. Ziolkowski Jr., M. Lutmerding, V. Aponte M-.R. Hudson. 2019. North American Breeding Bird Survey Dataset 1966 - 2018, version 2018.0. U.S. Geological Survey, Patuxent Wildlife Research Center. https://doi.org/10.5066/P9HE8XYJ.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/stratify.html","id":null,"dir":"Reference","previous_headings":"","what":"Stratify and filter Breeding Bird Survey data — stratify","title":"Stratify and filter Breeding Bird Survey data — stratify","text":"Assigns count data strata filters species interest. Routes assigned strata based geographic location stratification specified user. Species filtered matching English, French Scientific names BBS species data (see search_species() flexible search identify correct species names).","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/stratify.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Stratify and filter Breeding Bird Survey data — stratify","text":"","code":"stratify(   by,   species,   strata_custom = NULL,   combine_species_forms = TRUE,   release = 2022,   sample_data = FALSE,   quiet = FALSE,   lump_species_forms,   bbs_data )"},{"path":"http://steffilazerte.ca/bbsBayes/reference/stratify.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Stratify and filter Breeding Bird Survey data — stratify","text":"Character. Stratification type. Either established type, one \"prov_state\", \"bcr\", \"latlong\", \"bbs_cws\", \"bbs_usgs\", custom name (see strata_custom details). strata_custom Data frame sf spatial data frame. Data frame modified existing stratification, sf spatial data frame polygons defining custom stratifications. See Details. combine_species_forms Logical. Whether combine ambiguous species forms. See Details. sample_data Logical. Use sample data (just Pacific Wren) quiet Logical. Suppress progress messages lump_species_forms Deprecated. Use combine_species_forms instead bbs_data Defunct.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/stratify.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Stratify and filter Breeding Bird Survey data — stratify","text":"Large list meta_data, meta_strata, birds_strata, routes_strata","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/stratify.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Stratify and filter Breeding Bird Survey data — stratify","text":"define custom subset existing stratification, specify stratification (e.g., \"bbs_cws\") supply subset bbs_strata[[\"bbc_cws\"]] strata_custom (see examples). define completely new custom stratification, specify name like use (e.g., \"east_west_divide\") supply spatial data frame polygons identifying different strata strata_custom. Note data must column called strata_name names strata contained (see examples). combine_species_forms TRUE (default), species multiple forms (e.g., \"unid. Dusky Grouse / Sooty Grouse\") included overall species groupings (e.g., \"unid.\" combined \"Dusky Grouse\" \"Sooty Grouse\" \"Blue Grouse (Dusky/Sooty)\"). user wishes keep forms separate, combine_species_forms can set FALSE. See data frame species_forms, species set combined species. See vignette(\"stratification\", package = \"bbsBayes\") details.","code":""},{"path":"http://steffilazerte.ca/bbsBayes/reference/stratify.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Stratify and filter Breeding Bird Survey data — stratify","text":"","code":"# Sample Data - USGS BBS stara s <- stratify(by = \"bbs_usgs\", sample_data = TRUE) #> Using 'bbs_usgs' (standard) stratification #> Using sample BBS data... #> Using species Pacific Wren (sample data) #> Stratifying data... #>   Renaming routes...  # Full data - species and stratification # Use `search_species()` to get correct species name  # Stratify by Bird Conservation Regions s <- stratify(by = \"bcr\", species = \"Great Horned Owl\") #> Using 'bcr' (standard) stratification #> Loading BBS data... #> Filtering to species Great Horned Owl (3750) #> Stratifying data... #>   Renaming routes...  # Stratify by CWS BBS strata s <- stratify(by = \"bbs_cws\", species = \"Canada Jay\") #> Using 'bbs_cws' (standard) stratification #> Loading BBS data... #> Filtering to species Canada Jay (4840) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Renaming routes...  # Stratify by State/Province/Territory only s <- stratify(by = \"prov_state\", species = \"Common Loon\") #> Using 'prov_state' (standard) stratification #> Loading BBS data... #> Filtering to species Common Loon (70) #> Stratifying data... #>   Renaming routes...  # Stratify by blocks of 1 degree of latitude X 1 degree of longitude s <- stratify(by = \"latlong\", species = \"Snowy Owl\") #> Using 'latlong' (standard) stratification #> Loading BBS data... #> Filtering to species Snowy Owl (3760) #> Stratifying data... #>   Omitting 80/119,567 routes that do not match a stratum... #>   Renaming routes...  # Use combined or non-combined species forms  search_species(\"Sooty grouse\") #> # A tibble: 2 × 9 #>     aou english                french spanish order family genus species unid_…¹ #>   <dbl> <chr>                  <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #> 1  2971 Sooty Grouse           Tétra… Dendra… Gall… Phasi… Dend… fuligi… TRUE    #> 2  2973 Blue Grouse (Dusky/So… Tétra… Dendra… Gall… Phasi… Dend… obscur… TRUE    #> # … with abbreviated variable name ¹​unid_combined s <- stratify(by = \"bbs_usgs\", species = \"Blue Grouse (Dusky/Sooty)\") #> Using 'bbs_usgs' (standard) stratification #> Loading BBS data... #> Filtering to species Blue Grouse (Dusky/Sooty) (2973) #> Stratifying data... #>   Renaming routes... nrow(s$birds_strata) # Contains all Dusky, Sooty and unidentified #> [1] 1501  search_species(\"Sooty grouse\", combine_species_forms = FALSE) #> # A tibble: 2 × 9 #>     aou english                french spanish order family genus species unid_…¹ #>   <dbl> <chr>                  <chr>  <chr>   <chr> <chr>  <chr> <chr>   <lgl>   #> 1  2971 Sooty Grouse           Tétra… Dendra… Gall… Phasi… Dend… fuligi… FALSE   #> 2  2973 unid. Dusky Grouse / … unid … Dendra… Gall… Phasi… Dend… obscur… FALSE   #> # … with abbreviated variable name ¹​unid_combined s <- stratify(by = \"bbs_usgs\", species = \"unid. Dusky Grouse / Sooty Grouse\",               combine_species_forms = FALSE) #> Using 'bbs_usgs' (standard) stratification #> Loading BBS data... #> Filtering to species unid. Dusky Grouse / Sooty Grouse (2973) #> Stratifying data... #>   Renaming routes... nrow(s$birds_strata) # Contains *only* unidentified #> [1] 90   # Stratify by a subset of an existing stratification library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union my_cws <- filter(bbs_strata[[\"bbs_cws\"]], country_code == \"CA\") s <- stratify(by = \"bbs_cws\", strata_custom = my_cws, species = \"Snowy Owl\") #> Using 'bbs_cws' (subset) stratification #> Loading BBS data... #> Filtering to species Snowy Owl (3760) #> Stratifying data... #>   Combining BCR 7 and NS and PEI... #>   Omitting 101,474/119,567 routes that do not match a stratum... #>   Renaming routes...  my_bcr <- filter(bbs_strata[[\"bcr\"]], strata_name == \"BCR8\") s <- stratify(by = \"bcr\", strata_custom = my_bcr,               species = \"Yellow-rumped Warbler (all forms)\") #> Using 'bcr' (subset) stratification #> Loading BBS data... #> Filtering to species Yellow-rumped Warbler (all forms) (6556) #> Stratifying data... #>   Omitting 118,210/119,567 routes that do not match a stratum... #>   Renaming routes...  # Stratify by Custom stratification, using sf map object # e.g. with WBPHS stratum boundaries 2019 # available: https://ecos.fws.gov/ServCat/Reference/Profile/142628  if (FALSE) { map <- sf::read_sf(\"../WBPHS_Stratum_Boundaries_2019\") %>%   rename(strata_name = STRAT) # stratify expects this column  s <- stratify(by = \"WBPHS_2019\", strata_map = map) }"}]
